"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[980],{2980:(mt,O,s)=>{s.d(O,{Z:()=>ut});var t=s(5e3),v=s(953),x=s(833);function z(a){(0,x.Z)(1,arguments);var c=(0,v.Z)(a),e=new Date(0);return e.setFullYear(c.getFullYear(),0,1),e.setHours(0,0,0,0),e}var w=s(7623);function T(a){(0,x.Z)(1,arguments);var c=(0,v.Z)(a),e=(0,w.Z)(c,z(c)),i=e+1;return i}var h=s(1062),I=s(2966),N=s(408),q=s(8520),D=s(9777),M=s(6042),Z=s(2643),y=s(2683),p=s(3075),k=s(2374),S=s(9332),J=s(7003),g=s(9808),A=s(868),F=s(7815),P=s(656),U=s(2905),R=s(6695),Q=s(4173),b=s(3677);function Y(a,c){if(1&a){const e=t.EpF();t.TgZ(0,"button",13),t.NdJ("click",function(){t.CHM(e);const n=t.oxw().$implicit;return t.oxw().deleteCard(n.id)}),t._UZ(1,"i",14),t.qZA()}}function L(a,c){if(1&a){const e=t.EpF();t.TgZ(0,"div",15),t.TgZ(1,"div",9),t.TgZ(2,"nz-date-picker",16),t.NdJ("ngModelChange",function(n){return t.CHM(e),t.oxw().$implicit.fromDate=n}),t.qZA(),t.qZA(),t.TgZ(3,"div",11),t._uU(4,"-"),t.qZA(),t.TgZ(5,"div",9),t.TgZ(6,"nz-date-picker",16),t.NdJ("ngModelChange",function(n){return t.CHM(e),t.oxw().$implicit.toDate=n}),t.qZA(),t.qZA(),t.qZA()}if(2&a){const e=t.oxw().$implicit;t.xp6(2),t.Q6J("nzAllowClear",!1)("ngModel",e.fromDate),t.xp6(4),t.Q6J("nzAllowClear",!1)("ngModel",e.toDate)}}const H=function(a){return[a]};function V(a,c){if(1&a){const e=t.EpF();t.TgZ(0,"div",17),t.TgZ(1,"button",18),t.NdJ("ngModelChange",function(n){return t.CHM(e).$implicit.checked=n})("click",function(){const r=t.CHM(e).$implicit,o=t.oxw().$implicit;return t.oxw().onDayClick(r,o.id)}),t._uU(2),t.qZA(),t.qZA()}if(2&a){const e=c.$implicit,i=t.oxw().$implicit,n=t.oxw();t.xp6(1),t.s9C("name",e.label),t.s9C("value",e.value),t.s9C("id",e.label),t.Q6J("ngClass",t.VKq(7,H,e.checked&&e.card===i.id?"day selected":"day"))("ngModel",e.checked)("disabled",n.isDisabled(e,i)),t.xp6(1),t.Oqu(e.label)}}function G(a,c){if(1&a){const e=t.EpF();t.TgZ(0,"div",3),t.YNc(1,Y,2,0,"button",4),t.YNc(2,L,7,4,"div",5),t.TgZ(3,"div",6),t.YNc(4,V,3,9,"div",7),t.qZA(),t.TgZ(5,"div",8),t.TgZ(6,"div",9),t._UZ(7,"label"),t.TgZ(8,"nz-time-picker",10),t.NdJ("ngModelChange",function(n){return t.CHM(e).$implicit.fromTime=n}),t.qZA(),t.qZA(),t.TgZ(9,"div",11),t._uU(10,"-"),t.qZA(),t.TgZ(11,"div",9),t._UZ(12,"label"),t.TgZ(13,"nz-time-picker",12),t.NdJ("ngModelChange",function(n){return t.CHM(e).$implicit.toTime=n}),t.qZA(),t.qZA(),t.qZA(),t.qZA()}if(2&a){const e=c.$implicit,i=t.oxw();t.xp6(1),t.Q6J("ngIf",!i.isTariff),t.xp6(1),t.Q6J("ngIf",i.isTariff),t.xp6(2),t.Q6J("ngForOf",i.data),t.xp6(4),t.Q6J("nzPlaceHolder"," ")("nzAllowEmpty",!1)("ngModel",e.fromTime)("nzMinuteStep",i.isTariff?15:1),t.xp6(5),t.Q6J("nzPlaceHolder"," ")("ngModel",e.toTime)("nzAllowEmpty",!1)("nzMinuteStep",i.isTariff?15:1)}}function $(a,c){if(1&a){const e=t.EpF();t.TgZ(0,"div",19),t.TgZ(1,"button",20),t.NdJ("click",function(){return t.CHM(e),t.oxw().addNewCard()}),t._UZ(2,"i",21),t._uU(3),t.ALo(4,"translate"),t.qZA(),t.qZA()}if(2&a){const e=t.oxw();t.xp6(1),t.Q6J("disabled",e.cards.length>=7),t.xp6(2),t.hij(" ",t.lcZ(4,2,"ADD")," ")}}let W=(()=>{class a{constructor(){this.isTariff=!1,this.data=[{label:"Mo",value:"monday",checked:!1,card:null},{label:"Tu",value:"tuesday",checked:!1,card:null},{label:"We",value:"wednesday",checked:!1,card:null},{label:"Th",value:"thursday",checked:!1,card:null},{label:"Fr",value:"friday",checked:!1,card:null},{label:"Sa",value:"saturday",checked:!1,card:null},{label:"Su",value:"sunday",checked:!1,card:null}]}ngOnInit(){this.isTariff&&this.cards[0].days&&this.cards[0].days.forEach(e=>{this.data[e-1].checked=!0,this.data[e-1].card=0})}onDayClick(e,i){const n=this.data.findIndex(r=>r.value===e.value);this.data[n].card=i,this.data[n].checked=!this.data[n].checked,this.cards[i].days=this.data.map((r,o)=>r.checked?o+1:null).filter(r=>null!==r)}isDisabled(e,i){return e.checked&&e.card!==i.id}addNewCard(){this.cards.length<7&&this.cards.push({id:this.cards.length,fromDate:new Date(0,0,1,0,0,0),toDate:new Date(0,11,31,0,0,0),fromTime:new Date(0,0,0,7,0,0),toTime:new Date(0,0,0,15,0,0)})}deleteCard(e){this.data.filter(n=>n.card===e&&!0===n.checked).forEach(n=>{this.data.map((o,l)=>{if(o.card===n.card)return l}).filter(o=>void 0!==o).forEach(o=>{this.data[o].checked=!1})}),this.cards=this.cards.filter(n=>n.id!==e)}}return a.\u0275fac=function(e){return new(e||a)},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-scheduler"]],inputs:{header:"header",text:"text",isTariff:"isTariff",cards:"cards"},decls:3,vars:2,consts:[[1,"scheduler-container"],["class","scheduler-item",4,"ngFor","ngForOf"],["class","add-card",4,"ngIf"],[1,"scheduler-item"],["nz-button","","class","card-button-close",3,"click",4,"ngIf"],["class","scheduler-date",4,"ngIf"],[1,"scheduler-days"],["class","day-item",4,"ngFor","ngForOf"],[1,"scheduler-time"],[1,"form-group-item"],["nzFormat","HH:mm","nzNowText"," ",3,"nzPlaceHolder","nzAllowEmpty","ngModel","nzMinuteStep","ngModelChange"],[1,"time-separator"],["nzFormat","HH:mm","nzNowText"," ",3,"nzPlaceHolder","ngModel","nzAllowEmpty","nzMinuteStep","ngModelChange"],["nz-button","",1,"card-button-close",3,"click"],[1,"icon_abb_16","icon-abb_close_16"],[1,"scheduler-date"],["nzFormat","dd-MM","nzDropdownClassName","no-years","nzShowNow","false",3,"nzAllowClear","ngModel","ngModelChange"],[1,"day-item"],["nz-button","","id","day_item_button","nzTooltipPlacement","left","ngDefaultControl","","nz-tooltip","",3,"ngClass","ngModel","disabled","name","value","id","ngModelChange","click"],[1,"add-card"],["nz-button","","nz-dropdown","","id","add_button","nzTrigger","click",3,"disabled","click"],[1,"icon_abb_16","icon-abb_plus_16"]],template:function(e,i){1&e&&(t.TgZ(0,"div",0),t.YNc(1,G,14,11,"div",1),t.YNc(2,$,5,4,"div",2),t.qZA()),2&e&&(t.xp6(1),t.Q6J("ngForOf",i.cards),t.xp6(1),t.Q6J("ngIf",!i.isTariff))},directives:[g.sg,g.O5,M.ix,Z.dQ,y.w,U.uw,p.JJ,p.On,p.Fj,R.SY,g.mk,Q.m4,b.wA,b.cm],pipes:[h.X$],styles:[".scheduler-item[_ngcontent-%COMP%]{margin-top:15px;margin-left:5px;padding:15px 20px;width:calc(100% - 10px);box-shadow:0 4px 5px #bdbdbd;border-radius:15px;position:relative;display:flex;flex-direction:column;justify-content:space-between;row-gap:10px}.scheduler-item[_ngcontent-%COMP%]   .card-button-close[_ngcontent-%COMP%]{position:absolute;top:5px;right:5px}.scheduler-item[_ngcontent-%COMP%]   .scheduler-days[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center}.scheduler-item[_ngcontent-%COMP%]   .scheduler-time[_ngcontent-%COMP%]{display:flex}.scheduler-item[_ngcontent-%COMP%]   .scheduler-time[_ngcontent-%COMP%]   .form-group-item[_ngcontent-%COMP%]{width:100px}.scheduler-item[_ngcontent-%COMP%]   .scheduler-time[_ngcontent-%COMP%]   .time-separator[_ngcontent-%COMP%]{margin:0 5px;line-height:31px}.scheduler-item[_ngcontent-%COMP%]   .scheduler-date[_ngcontent-%COMP%]{display:flex}.scheduler-item[_ngcontent-%COMP%]   .scheduler-date[_ngcontent-%COMP%]   .form-group-item[_ngcontent-%COMP%]{width:100px;margin-bottom:0}.scheduler-item[_ngcontent-%COMP%]   .scheduler-date[_ngcontent-%COMP%]   .time-separator[_ngcontent-%COMP%]{margin:0 5px;line-height:31px}.day-item[_ngcontent-%COMP%]   .ant-btn[_ngcontent-%COMP%]{border-radius:50%;border:1px solid transparent!important;transition:.2s linear;transition-property:color,background-color,border-color;font-size:12px;text-align:center;line-height:10px;padding:0;height:33px;width:33px;display:inline-flex;align-items:center;background-color:transparent;border:1px solid transparent;color:#ff000f;box-shadow:none;margin-right:5px}.day-item[_ngcontent-%COMP%]   .ant-btn.selected[_ngcontent-%COMP%]{border:1px solid black!important;border-radius:50%}nz-time-picker[_ngcontent-%COMP%]   .ant-picker-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{box-shadow:none!important}.add-card[_ngcontent-%COMP%]{margin-top:20px}"]}),a})();const B=function(){return{required:!0}};function j(a,c){if(1&a){const e=t.EpF();t.TgZ(0,"div",5),t.TgZ(1,"label"),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"app-select",21),t.NdJ("modelChange",function(n){return t.CHM(e),t.oxw().editContract.deviceIds=n}),t.qZA(),t.qZA()}if(2&a){const e=t.oxw();t.xp6(2),t.Oqu(t.lcZ(3,5,"DEVICES")),t.xp6(2),t.Q6J("model",e.editContract.deviceIds)("multiple",!0)("options",e.devices)("validators",t.DdM(7,B))}}function X(a,c){1&a&&(t._uU(0),t.ALo(1,"translate")),2&a&&t.Oqu(t.lcZ(1,1,"ENERGY_IMPORTED"))}function K(a,c){1&a&&t.GkF(0)}function tt(a,c){1&a&&(t._uU(0),t.ALo(1,"translate")),2&a&&t.Oqu(t.lcZ(1,1,"ENERGY_EXPORTED"))}function et(a,c){1&a&&t.GkF(0)}function nt(a,c){1&a&&(t._uU(0),t.ALo(1,"translate")),2&a&&t.Oqu(t.lcZ(1,1,"WATER_GAS"))}function it(a,c){1&a&&t.GkF(0)}const at=function(){return{type:"waterGas"}};function rt(a,c){if(1&a&&(t.TgZ(0,"nz-tab",13),t.YNc(1,nt,2,3,"ng-template",null,16,t.W1O),t.YNc(3,it,1,0,"ng-container",15),t.qZA()),2&a){const e=t.MAs(2);t.oxw();const i=t.MAs(41);t.Q6J("nzTitle",e),t.xp6(3),t.Q6J("ngTemplateOutlet",i)("ngTemplateOutletContext",t.DdM(3,at))}}const ot=function(a,c){return{required:!0,invalidValues:a,invalidValuesMsg:c}};function ct(a,c){if(1&a){const e=t.EpF();t.TgZ(0,"div"),t.TgZ(1,"div",28),t._uU(2),t.ALo(3,"translate"),t.TgZ(4,"span",29),t.NdJ("click",function(){t.CHM(e);const n=t.oxw().index;return t.oxw(2).removeTariff(n)}),t._uU(5),t.ALo(6,"translate"),t.qZA(),t.qZA(),t.TgZ(7,"div",5),t.TgZ(8,"label",6),t._uU(9),t.ALo(10,"translate"),t.qZA(),t.TgZ(11,"app-validate",7),t.TgZ(12,"input",30,31),t.NdJ("ngModelChange",function(n){return t.CHM(e),t.oxw().$implicit.name=n}),t.qZA(),t.qZA(),t.qZA(),t.TgZ(14,"div",5),t.TgZ(15,"label",6),t._uU(16),t.ALo(17,"translate"),t.qZA(),t.TgZ(18,"app-select",32),t.NdJ("modelChange",function(n){return t.CHM(e),t.oxw().$implicit.tags=n}),t.ALo(19,"translate"),t.qZA(),t.qZA(),t.TgZ(20,"div",5),t.TgZ(21,"label",6),t._uU(22),t.ALo(23,"translate"),t.qZA(),t.TgZ(24,"app-validate",7),t.TgZ(25,"nz-input-number",33,34),t.NdJ("ngModelChange",function(n){return t.CHM(e),t.oxw().$implicit.cost=n}),t.qZA(),t.qZA(),t.qZA(),t.qZA()}if(2&a){const e=t.MAs(13),i=t.MAs(26),n=t.oxw(),r=n.index,o=n.$implicit,l=t.oxw().type,d=t.oxw();t.xp6(2),t.hij("",t.lcZ(3,27,"TARIFF")," "),t.xp6(3),t.Oqu(t.lcZ(6,29,"REMOVE_TARIFF_BUTTON")),t.xp6(4),t.Oqu(t.lcZ(10,31,"NAME")),t.xp6(2),t.Q6J("field",e),t.xp6(1),t.MGl("id","tariff_name_input_",r,""),t.MGl("name","tariffName",r,""),t.Q6J("ngModel",o.name)("appValidateUnique",d.editContract.tariffs)("initValue",o.name),t.xp6(4),t.Oqu(t.lcZ(17,33,"TAG")),t.xp6(2),t.MGl("inputId","tag_select_",r,""),t.Q6J("model",o.tags)("options",d.getMeterTariffTags(l,o,d.editContract.type))("multiple",!0)("validators",t.WLB(39,ot,d.validateTags(d.editContract),t.lcZ(19,35,"CONTRACT_TAGS_OVERLAP_ERROR"))),t.xp6(4),t.AsE("",t.lcZ(23,37,"COST")," [",d.currency.symbol,"]"),t.xp6(2),t.Q6J("field",i),t.xp6(1),t.MGl("id","cost_input_wrapper_",r,""),t.MGl("nzId","cost_input_",r,""),t.MGl("name","cost",r,""),t.Q6J("ngModel",o.cost)("required",!0)("nzMin",0)("nzMax",2147483647)("nzStep",.01)("nzPrecision",2)}}function st(a,c){if(1&a&&t._UZ(0,"app-scheduler",35),2&a){const e=t.oxw().$implicit;t.Q6J("cards",e.scheduler)("isTariff",!0)}}function lt(a,c){1&a&&(t.TgZ(0,"div",36),t.TgZ(1,"div"),t._UZ(2,"span",37),t._uU(3),t.ALo(4,"translate"),t.qZA(),t.qZA()),2&a&&(t.xp6(3),t.Oqu(t.lcZ(4,1,"TARIFF_OVERLAP_ERROR")))}function dt(a,c){if(1&a&&(t.TgZ(0,"div"),t.YNc(1,ct,27,42,"div",25),t.YNc(2,st,1,2,"app-scheduler",26),t.YNc(3,lt,5,3,"div",27),t.qZA()),2&a){const e=c.$implicit,i=c.index,n=t.oxw().type,r=t.oxw();t.xp6(1),t.Q6J("ngIf",e.type===n),t.xp6(1),t.Q6J("ngIf",e.type===n&&0===r.editContract.type),t.xp6(1),t.Q6J("ngIf",e.type===n&&0===r.editContract.type&&r.validateTariffs(e,i))}}function pt(a,c){if(1&a){const e=t.EpF();t.TgZ(0,"div"),t.YNc(1,dt,4,3,"div",22),t.TgZ(2,"button",23),t.NdJ("click",function(){const r=t.CHM(e).type;return t.oxw().addTariff(r)}),t._UZ(3,"i",24),t._uU(4),t.ALo(5,"translate"),t.qZA(),t.qZA()}if(2&a){const e=t.oxw();t.xp6(1),t.Q6J("ngForOf",e.editContract.tariffs),t.xp6(3),t.Oqu(t.lcZ(5,2,"ADD_TARIFF_BUTTON"))}}const ft=function(){return{type:"import"}},gt=function(){return{type:"export"}};let ut=(()=>{class a{constructor(e,i,n,r,o){this.translate=e,this.toastr=i,this.drawerService=n,this.tarifsService=r,this.appLoadService=o,this.id="energy_monitoring_contracts_configuration_analysis",this.callback=new t.vpe,this.saving=!1,this.takenNames=[],this.types=[{id:0,text:"VIRTUAL_TARIFF"},{id:1,text:"METER_MANAGED_TARIFF"}],this.meterTariffTags=[{id:"activeImportTariff1",text:"activeImportTariff1"},{id:"activeImportTariff2",text:"activeImportTariff2"},{id:"activeImportTariff3",text:"activeImportTariff3"},{id:"activeImportTariff4",text:"activeImportTariff4"},{id:"activeImportTariff5",text:"activeImportTariff5"},{id:"activeImportTariff6",text:"activeImportTariff6"},{id:"activeImportTariff7",text:"activeImportTariff7"},{id:"activeImportTariff8",text:"activeImportTariff8"},{id:"activeExportTariff1",text:"activeExportTariff1"},{id:"activeExportTariff2",text:"activeExportTariff2"},{id:"activeExportTariff3",text:"activeExportTariff3"},{id:"activeExportTariff4",text:"activeExportTariff4"},{id:"activeExportTariff5",text:"activeExportTariff5"},{id:"activeExportTariff6",text:"activeExportTariff6"},{id:"activeExportTariff7",text:"activeExportTariff7"},{id:"activeExportTariff8",text:"activeExportTariff8"},{id:"reactiveImportTariff1",text:"reactiveImportTariff1"},{id:"reactiveImportTariff2",text:"reactiveImportTariff2"},{id:"reactiveImportTariff3",text:"reactiveImportTariff3"},{id:"reactiveImportTariff4",text:"reactiveImportTariff4"},{id:"reactiveImportTariff5",text:"reactiveImportTariff5"},{id:"reactiveImportTariff6",text:"reactiveImportTariff6"},{id:"reactiveImportTariff7",text:"reactiveImportTariff7"},{id:"reactiveImportTariff8",text:"reactiveImportTariff8"},{id:"reactiveExportTariff1",text:"reactiveExportTariff1"},{id:"reactiveExportTariff2",text:"reactiveExportTariff2"},{id:"reactiveExportTariff3",text:"reactiveExportTariff3"},{id:"reactiveExportTariff4",text:"reactiveExportTariff4"},{id:"reactiveExportTariff5",text:"reactiveExportTariff5"},{id:"reactiveExportTariff6",text:"reactiveExportTariff6"},{id:"reactiveExportTariff7",text:"reactiveExportTariff7"},{id:"reactiveExportTariff8",text:"reactiveExportTariff8"},{id:"WaterGasWater",text:"Water"},{id:"WaterGasGas",text:"Gas"}]}ngOnInit(){this.currency=this.appLoadService.currency.value,this.initContract=[...this.editContract.tariffs],this.takenNames=this.contracts.map(e=>e.name),this.nameInitValue=this.editContract.name}addTariff(e){this.editContract.tariffs.push({type:e,tags:[],name:"",cost:"",scheduler:[{id:0,fromDate:new Date(2e3,0,1,0,0,0),toDate:new Date(2e3,11,31,0,0,0),fromTime:new Date(2e3,0,0,7,0,0),toTime:new Date(2e3,0,0,15,0,0)}]})}closeDrawer(){this.drawerService.hide()}saveContract(){if(this.toastr.clear(),0===this.editContract.tariffs.length)return void this.toastr.warning(this.translate.instant("CONTRACT_NO_TARIFFS"));if(0===this.editContract.type){let n=!1,r=!1;if(this.editContract.tariffs.forEach((o,l)=>{this.validateTariffs(o,l)&&(n=!0),(!o.scheduler[0].days||0===o.scheduler[0].days)&&(r=!0)}),r)return void this.toastr.warning(this.translate.instant("CONTRACT_TARIFFS_NO_DAYS"));if(n)return void this.toastr.warning(this.translate.instant("CONTRACT_TARIFFS_OVERLAP"))}let e,i;if(this.saving=!0,this.editContract.id){if(e="CONTRACT_EDIT_SUCCESS",i=this.tarifsService.saveContract(this.editContract),"wizard"===this.type){const n=this.contracts.find(r=>r.id===this.editContract.id);n&&(n.name=this.editContract.name,n.cost=this.editContract.cost)}}else e="CONTRACT_ADD_SUCCESS",i=this.tarifsService.addContract(this.editContract),"wizard"===this.type&&(this.editContract.id=this.contracts.length+1,this.contracts.push(this.editContract));"wizard"===this.type?(this.saving=!1,this.closeDrawer()):i.subscribe(()=>{this.toastr.success(this.translate.instant(e,{name:"<strong>"+this.editContract.name+"</strong>"})),this.saving=!1,this.closeDrawer(),this.callback&&this.callback.next("")},()=>{this.toastr.error(this.translate.instant("REQUEST_ERROR")),this.saving=!1})}getMeterTariffTags(e,i,n){return this.meterTariffTags.filter(o=>{let l=this.editContract.tariffs.some(d=>d.tags.includes(o.id));return 0===n&&(l=!1),o.id.toLowerCase().includes(e.toLowerCase())&&(!l||i.tags.includes(o.id))})}removeTariff(e){this.editContract.tariffs.splice(e,1)}contractTypeChanged(){0===this.editContract.type&&this.editContract.tariffs.forEach(e=>{e.scheduler||(e.scheduler=[{id:0,fromDate:new Date(2e3,0,1,0,0,0),toDate:new Date(2e3,11,31,0,0,0),fromTime:new Date(2e3,0,0,7,0,0),toTime:new Date(2e3,0,0,15,0,0)}])})}validateTags(e){if("wizard"===this.type)return;let i=[];return this.contracts.forEach(n=>{if(n.id!==e.id&&n.deviceIds.length+e.deviceIds.length!==new Set([...n.deviceIds,...e.deviceIds]).size){const r=new Set([...n.tariffs.reduce((o,l)=>[...o,...l.tags],[])]);i=[...new Set([...i,...r])]}}),i}validateTariffs(e,i){if(1===this.editContract.type||!e.scheduler)return;const n={dateOverlap:!1,dayOverlap:!1,timeOverlap:!1},r=T(e.scheduler[0].fromDate),o=T(e.scheduler[0].toDate),l=60*e.scheduler[0].fromTime.getHours()+e.scheduler[0].fromTime.getMinutes(),d=60*e.scheduler[0].toTime.getHours()+e.scheduler[0].toTime.getMinutes();return this.editContract.tariffs.forEach((f,_t)=>{if(_t===i)return;let E=!1;if(e.tags.length+f.tags.length!==new Set([...e.tags,...f.tags]).size&&(E=!0),!E)return;const u=T(f.scheduler[0].fromDate),_=T(f.scheduler[0].toDate),m=60*f.scheduler[0].fromTime.getHours()+f.scheduler[0].fromTime.getMinutes(),C=60*f.scheduler[0].toTime.getHours()+f.scheduler[0].toTime.getMinutes();(u<=_&&(r>=u&&r<=_||o>=u&&o<=_)||u>_&&(r>=u||r<=_||o>=u||o<=_))&&(n.dateOverlap=!0),e.scheduler[0].days&&f.scheduler[0].days&&e.scheduler[0].days.length+f.scheduler[0].days.length!==new Set([...e.scheduler[0].days,...f.scheduler[0].days]).size&&(n.dayOverlap=!0),(m<C&&(l>=m&&l<C||d>m&&d<=C)||m>C&&(l>=m||l<C||d>m||d<=C))&&(n.timeOverlap=!0)}),n.dateOverlap&&n.dayOverlap&&n.timeOverlap}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(h.sK),t.Y36(I._),t.Y36(N.z),t.Y36(q.M),t.Y36(D.V))},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-energy-monitoring-contracts-configuration"]],hostVars:1,hostBindings:function(e,i){2&e&&t.uIk("id",i.id)},inputs:{editContract:"editContract",contracts:"contracts",devices:"devices",type:"type"},outputs:{callback:"callback"},decls:42,vars:37,consts:[["tabIndex","-1","nz-button","","id","close_contract_button",1,"drawer-button-close",3,"click"],[1,"icon_abb_16","icon-abb_close_16"],[1,"drawer-title","text-line"],[1,"drawer-body"],["formAdd","ngForm"],[1,"form-group"],[1,"label-required"],[3,"field"],["type","text","maxlength","255","id","name_input","name","name","required","","appValidateUniqueType","tableProperty",1,"form-control",3,"ngModel","appValidateUnique","initValue","ngModelChange"],["name","ngModel"],["inputId","type_select",3,"model","options","modelChange","callbackChange"],["class","form-group",4,"ngIf"],["nzType","card",2,"margin-top","20px",3,"nzAnimated"],[3,"nzTitle"],["titleImport",""],[4,"ngTemplateOutlet","ngTemplateOutletContext"],["titleWaterGas",""],[3,"nzTitle",4,"ngIf"],["type","button","nz-button","",3,"click"],["type","submit","nz-button","","nzType","primary",3,"nzLoading","disabled","form","appFormButtonClick"],["tab",""],["inputId","device_select",3,"model","multiple","options","validators","modelChange"],[4,"ngFor","ngForOf"],["nz-button","","type","button","nzType","default",2,"margin-top","10px",3,"click"],[1,"icon_abb_16","icon-abb_plus_16"],[4,"ngIf"],[3,"cards","isTariff",4,"ngIf"],["class","validation-error",4,"ngIf"],[1,"drawer-subtitle"],[1,"red",3,"click"],["type","text","maxlength","255","appValidateUniqueType","name","required","",1,"form-control",3,"id","name","ngModel","appValidateUnique","initValue","ngModelChange"],["tariffName","ngModel"],[3,"model","options","multiple","inputId","validators","modelChange"],[3,"ngModel","id","nzId","name","required","nzMin","nzMax","nzStep","nzPrecision","ngModelChange"],["cost","ngModel"],[3,"cards","isTariff"],[1,"validation-error"],[1,"icon_abb_16","icon-abb_error-circle-1_16"]],template:function(e,i){if(1&e&&(t.TgZ(0,"button",0),t.NdJ("click",function(){return i.closeDrawer()}),t._UZ(1,"i",1),t.qZA(),t.TgZ(2,"div",2),t._uU(3),t.ALo(4,"translate"),t.qZA(),t.TgZ(5,"div",3),t.TgZ(6,"form",null,4),t.TgZ(8,"div",5),t.TgZ(9,"label",6),t._uU(10),t.ALo(11,"translate"),t.qZA(),t.TgZ(12,"app-validate",7),t.TgZ(13,"input",8,9),t.NdJ("ngModelChange",function(r){return i.editContract.name=r}),t.qZA(),t.qZA(),t.qZA(),t.TgZ(15,"div",5),t.TgZ(16,"label"),t._uU(17),t.ALo(18,"translate"),t.qZA(),t.TgZ(19,"app-select",10),t.NdJ("modelChange",function(r){return i.editContract.type=r})("callbackChange",function(){return i.contractTypeChanged()}),t.qZA(),t.qZA(),t.YNc(20,j,5,8,"div",11),t.TgZ(21,"div"),t.TgZ(22,"nz-tabset",12),t.TgZ(23,"nz-tab",13),t.YNc(24,X,2,3,"ng-template",null,14,t.W1O),t.YNc(26,K,1,0,"ng-container",15),t.qZA(),t.TgZ(27,"nz-tab",13),t.YNc(28,tt,2,3,"ng-template",null,16,t.W1O),t.YNc(30,et,1,0,"ng-container",15),t.qZA(),t.YNc(31,rt,4,4,"nz-tab",17),t.qZA(),t.qZA(),t.TgZ(32,"div",5),t._UZ(33,"label"),t.TgZ(34,"button",18),t.NdJ("click",function(){return i.closeDrawer()}),t._uU(35),t.ALo(36,"translate"),t.qZA(),t.TgZ(37,"button",19),t.NdJ("appFormButtonClick",function(){return i.saveContract()}),t._uU(38),t.ALo(39,"translate"),t.qZA(),t.qZA(),t.YNc(40,pt,6,4,"ng-template",null,20,t.W1O),t.qZA(),t.qZA()),2&e){const n=t.MAs(7),r=t.MAs(14),o=t.MAs(25),l=t.MAs(29),d=t.MAs(41);t.xp6(3),t.hij(" ",t.lcZ(4,25,"CONTRACT_CONFIGURATION")," "),t.xp6(7),t.Oqu(t.lcZ(11,27,"NAME")),t.xp6(2),t.Q6J("field",r),t.xp6(1),t.Q6J("ngModel",i.editContract.name)("appValidateUnique",i.takenNames)("initValue",i.nameInitValue),t.xp6(4),t.Oqu(t.lcZ(18,29,"CONTRACT_TYPE")),t.xp6(2),t.Q6J("model",i.editContract.type)("options",i.types),t.xp6(1),t.Q6J("ngIf","wizard"!==i.type),t.xp6(2),t.Q6J("nzAnimated",!1),t.xp6(1),t.Q6J("nzTitle",o),t.xp6(3),t.Q6J("ngTemplateOutlet",d)("ngTemplateOutletContext",t.DdM(35,ft)),t.xp6(1),t.Q6J("nzTitle",l),t.xp6(3),t.Q6J("ngTemplateOutlet",d)("ngTemplateOutletContext",t.DdM(36,gt)),t.xp6(1),t.Q6J("ngIf",0===i.editContract.type),t.xp6(3),t.uIk("id","drawer_cancel_button"),t.xp6(1),t.Oqu(t.lcZ(36,31,"CANCEL")),t.xp6(2),t.Q6J("nzLoading",i.saving)("disabled",i.saving)("form",n),t.uIk("id","modal_ok_button"),t.xp6(1),t.Oqu(t.lcZ(39,33,i.editContract.id||i.editContract.contract_id?"SAVE_CONTRACT":"ADD_CONTRACT"))}},directives:[M.ix,Z.dQ,y.w,p._Y,p.JL,p.F,k.P,p.Fj,p.nD,p.Q7,p.JJ,p.On,S.o,J.H,g.O5,A.xH,A.xw,g.tP,F.b,g.sg,P._,W],pipes:[h.X$],styles:[".section-content[_ngcontent-%COMP%]{padding:0}.widget-empty[_ngcontent-%COMP%]{display:flex;flex:1 1 auto;overflow:auto;justify-content:center;align-items:center}"]}),a})()}}]);