"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[526],{1526:(b,A,r)=>{r.r(A),r.d(A,{LoadManagementModule:()=>re});var p=r(4521),C=r(5724),t=r(5e3),d=r(1062),m=r(2966),c=r(4063),h=r(520);let v=(()=>{class a{constructor(e){this.http=e}getAutomationsConfiguration(){return this.http.get("api/automations/configuration")}saveAutomation(e){return this.http.post("api/automations",e,{responseType:"text"})}setAutomation(e){return this.http.put("api/automations",e,{responseType:"text"})}toggleAutomationStatus(e,n){return this.http.put("/api/automations/change-status",{ids:e,action:n},{responseType:"text"})}remove(e){return this.http.post("api/automations/remove",{id:e},{responseType:"text"})}}return a.\u0275fac=function(e){return new(e||a)(t.LFG(h.eN))},a.\u0275prov=t.Yz7({token:a,factory:a.\u0275fac,providedIn:"root"}),a})();var x=r(408),E=r(6042),I=r(2643),D=r(2683),M=r(9808),y=r(8868),z=r(9767),_=r(2364),J=r(7003),q=r(6462),T=r(3075),H=r(6695),U=r(2013),F=r(2374),Q=r(656),V=r(7815),R=r(442),B=r(83);const Y=["addAutomationDrawer"],j=["addConditionDrawer"];function W(a,s){1&a&&t._UZ(0,"app-loader")}function G(a,s){if(1&a){const e=t.EpF();t.TgZ(0,"div",33),t.TgZ(1,"span",34),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"button",35),t.NdJ("click",function(){t.CHM(e),t.oxw();const o=t.MAs(2);return t.oxw().removeAllSelected(o)}),t._UZ(5,"i",36),t._uU(6),t.ALo(7,"translate"),t.qZA(),t.TgZ(8,"button",37),t.NdJ("click",function(){t.CHM(e),t.oxw();const o=t.MAs(2);return t.oxw().toggleEnableDisable(o,"enable")}),t._UZ(9,"span",38),t._uU(10),t.ALo(11,"translate"),t.qZA(),t.TgZ(12,"button",39),t.NdJ("click",function(){t.CHM(e),t.oxw();const o=t.MAs(2);return t.oxw().toggleEnableDisable(o,"disable")}),t._UZ(13,"span",40),t._uU(14),t.ALo(15,"translate"),t.qZA(),t.qZA()}if(2&a){t.oxw();const e=t.MAs(2);t.xp6(2),t.AsE("",e.nrOfSelected," ",t.lcZ(3,5,"SELECTED"),""),t.xp6(4),t.Oqu(t.lcZ(7,7,"REMOVE")),t.xp6(4),t.Oqu(t.lcZ(11,9,"ENABLE_SELECTED")),t.xp6(4),t.Oqu(t.lcZ(15,11,"DISABLE_SELECTED"))}}function $(a,s){if(1&a&&(t.TgZ(0,"span"),t._UZ(1,"i",44),t._uU(2),t.ALo(3,"translate"),t.qZA()),2&a){const e=t.oxw().$implicit;t.xp6(2),t.Oqu(t.lcZ(3,1,e.variable||"-"))}}function K(a,s){if(1&a&&(t.TgZ(0,"span"),t._UZ(1,"i",44),t._uU(2),t.ALo(3,"toUnit"),t.qZA()),2&a){const e=t.oxw().$implicit;t.xp6(2),t.AsE("",e.threshold," ",t.lcZ(3,2,e.unit),"")}}function X(a,s){if(1&a&&(t.TgZ(0,"span",43),t._uU(1),t.ALo(2,"valueFromId"),t.qZA()),2&a){const e=t.oxw(2).$implicit,n=t.oxw(2);t.xp6(1),t.Oqu(t.Dn7(2,1,e.logical,n.logicals,"text"))}}function tt(a,s){if(1&a&&(t.TgZ(0,"div"),t.TgZ(1,"span",43),t.TgZ(2,"span"),t._uU(3),t.qZA(),t.YNc(4,$,4,3,"span",3),t.TgZ(5,"span"),t._UZ(6,"i",44),t._uU(7),t.ALo(8,"valueFromId"),t.qZA(),t.YNc(9,K,4,4,"span",3),t.qZA(),t.YNc(10,X,3,5,"span",50),t.qZA()),2&a){const e=s.$implicit,n=s.index,o=t.oxw().$implicit,i=t.oxw(2);t.xp6(3),t.Oqu(e.device_name||"-"),t.xp6(1),t.Q6J("ngIf",4!==e.type&&5!==e.type),t.xp6(3),t.Oqu(t.Dn7(8,5,e.type,i.automationTypesAll,"text")),t.xp6(2),t.Q6J("ngIf",4!==e.type&&5!==e.type&&3!==e.type&&6!==e.type),t.xp6(1),t.Q6J("ngIf",0===n&&o.condition.length>1)}}function et(a,s){if(1&a&&(t.TgZ(0,"span"),t._uU(1),t._UZ(2,"i",44),t.qZA()),2&a){const e=t.oxw().$implicit;t.xp6(1),t.Oqu(e.action.variable_name||"-")}}function nt(a,s){if(1&a){const e=t.EpF();t.TgZ(0,"tr"),t.TgZ(1,"td",41),t.NdJ("nzCheckedChange",function(o){const l=t.CHM(e).$implicit;return t.oxw(),t.MAs(2).onItemSelected(l,o)}),t.qZA(),t.TgZ(2,"td",24),t._uU(3),t.qZA(),t.TgZ(4,"td"),t._uU(5),t.qZA(),t.TgZ(6,"td"),t.YNc(7,tt,11,9,"div",42),t.qZA(),t.TgZ(8,"td"),t.TgZ(9,"span",43),t.TgZ(10,"span"),t._uU(11),t._UZ(12,"i",44),t.qZA(),t.YNc(13,et,3,1,"span",3),t.TgZ(14,"span"),t._uU(15),t.ALo(16,"valueFromId"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(17,"td",45),t._uU(18),t.ALo(19,"valueFromId"),t.qZA(),t.TgZ(20,"td",45),t._uU(21),t.ALo(22,"valueFromId"),t.qZA(),t.TgZ(23,"td",45),t._uU(24),t.ALo(25,"valueFromId"),t.qZA(),t.TgZ(26,"td"),t.TgZ(27,"nz-switch",46),t.NdJ("ngModelChange",function(o){return t.CHM(e).$implicit.status=o})("click",function(){const i=t.CHM(e).$implicit;return t.oxw(2).toggleStatus(i)}),t.qZA(),t._uU(28),t.ALo(29,"valueFromId"),t.qZA(),t.TgZ(30,"td",47),t.TgZ(31,"button",48),t.NdJ("click",function(){const i=t.CHM(e).$implicit;return t.oxw(2).openAutomationDrawer(i)}),t.ALo(32,"translate"),t._UZ(33,"i",49),t.qZA(),t.qZA(),t.qZA()}if(2&a){const e=s.$implicit,n=s.index;t.oxw();const o=t.MAs(2),i=t.oxw();t.xp6(1),t.MGl("id","table_item_checkbox_",n,""),t.Q6J("nzLeft",o.allowNzLeft)("nzChecked",e.selected),t.xp6(1),t.Q6J("nzLeft",o.allowNzLeft),t.xp6(1),t.Oqu(e.id),t.xp6(2),t.Oqu(e.name),t.xp6(2),t.Q6J("ngForOf",e.condition),t.xp6(4),t.Oqu(e.action.device_name||"-"),t.xp6(2),t.Q6J("ngIf","circuitBreakerCommand"!==e.action.variable),t.xp6(2),t.Oqu(t.Dn7(16,18,e.action.value,i.actions,"text")),t.xp6(3),t.Oqu(t.Dn7(19,22,e.event,i.yesNo,"text")),t.xp6(3),t.Oqu(t.Dn7(22,26,e.send_email,i.yesNo,"text")),t.xp6(3),t.Oqu(t.Dn7(25,30,e.raise_alarm,i.yesNo,"text")),t.xp6(3),t.Q6J("nzControl",!0)("ngModel",e.status),t.xp6(1),t.hij(" ",t.Dn7(29,34,e.status,i.enableDisable,"text"),""),t.xp6(3),t.MGl("id","edit_automation_button_",n,""),t.s9C("nzTooltipTitle",t.lcZ(32,38,"EDIT"))}}const ot=function(){return{key:"id",value:"ascend"}},at=function(a,s){return{x:a,y:s}},Z=function(){return["ascend","descend"]};function it(a,s){if(1&a){const e=t.EpF();t.TgZ(0,"div",9),t.TgZ(1,"app-table",10,11),t.YNc(3,G,16,13,"div",12),t.TgZ(4,"nz-table",13,14),t.ALo(6,"translate"),t.TgZ(7,"thead",15),t.NdJ("nzSortOrderChange",function(o){return t.CHM(e),t.MAs(2).sort(o)}),t.TgZ(8,"tr"),t.TgZ(9,"th",16),t.NdJ("nzCheckedChange",function(o){return t.CHM(e),t.MAs(2).onAllSelected(o)}),t.qZA(),t.TgZ(10,"th",17),t._uU(11),t.ALo(12,"translate"),t.qZA(),t.TgZ(13,"th",18),t._uU(14),t.ALo(15,"translate"),t.qZA(),t.TgZ(16,"th",19),t._uU(17),t.ALo(18,"translate"),t.qZA(),t.TgZ(19,"th",19),t._uU(20),t.ALo(21,"translate"),t.qZA(),t.TgZ(22,"th",20),t._uU(23),t.ALo(24,"translate"),t.qZA(),t.TgZ(25,"th",20),t._uU(26),t.ALo(27,"translate"),t.qZA(),t.TgZ(28,"th",20),t._uU(29),t.ALo(30,"translate"),t.qZA(),t.TgZ(31,"th",21),t._uU(32),t.ALo(33,"translate"),t.qZA(),t.TgZ(34,"th",22),t._uU(35),t.ALo(36,"translate"),t.qZA(),t.qZA(),t.TgZ(37,"tr",23),t._UZ(38,"th",24),t.TgZ(39,"th",25),t.TgZ(40,"input",26),t.NdJ("input",function(o){return t.CHM(e),t.MAs(2).filter(o,"id","contains")}),t.qZA(),t.qZA(),t.TgZ(41,"th",27),t.TgZ(42,"input",26),t.NdJ("input",function(o){return t.CHM(e),t.MAs(2).filter(o,"name","contains")}),t.qZA(),t.qZA(),t._UZ(43,"th"),t._UZ(44,"th"),t.TgZ(45,"th"),t.TgZ(46,"app-select",28),t.NdJ("modelChange",function(o){return t.CHM(e),t.MAs(2).filtersModel.event=o})("callbackChange",function(){t.CHM(e);const o=t.MAs(2);return o.filter(o.filtersModel.event,"event","equals")}),t.qZA(),t.qZA(),t.TgZ(47,"th"),t.TgZ(48,"app-select",29),t.NdJ("modelChange",function(o){return t.CHM(e),t.MAs(2).filtersModel.send_email=o})("callbackChange",function(){t.CHM(e);const o=t.MAs(2);return o.filter(o.filtersModel.send_email,"send_email","equals")}),t.qZA(),t.qZA(),t.TgZ(49,"th"),t.TgZ(50,"app-select",30),t.NdJ("modelChange",function(o){return t.CHM(e),t.MAs(2).filtersModel.raise_alarm=o})("callbackChange",function(){t.CHM(e);const o=t.MAs(2);return o.filter(o.filtersModel.raise_alarm,"raise_alarm","equals")}),t.qZA(),t.qZA(),t.TgZ(51,"th"),t.TgZ(52,"app-select",31),t.NdJ("modelChange",function(o){return t.CHM(e),t.MAs(2).filtersModel.status=o})("callbackChange",function(){t.CHM(e);const o=t.MAs(2);return o.filter(o.filtersModel.status,"status","equals")}),t.qZA(),t.qZA(),t._UZ(53,"th"),t.qZA(),t.qZA(),t.TgZ(54,"tbody"),t.YNc(55,nt,34,40,"tr",32),t.qZA(),t.qZA(),t.qZA(),t.qZA()}if(2&a){const e=t.MAs(2),n=t.MAs(5),o=t.oxw();t.xp6(1),t.Q6J("initSort",t.DdM(79,ot))("data",o.rows),t.xp6(2),t.Q6J("ngIf",e.nrOfSelected),t.xp6(1),t.Q6J("nzData",e.tableData)("nzFrontPagination",!1)("nzScroll",t.WLB(80,at,e.tableWidth,e.tableHeight))("nzNoResult",t.lcZ(6,59,"NO_AUTOMATIONS")),t.xp6(5),t.Q6J("nzLeft",e.allowNzLeft)("nzChecked",e.selected)("nzIndeterminate",e.indeterminate),t.xp6(1),t.Q6J("nzLeft",e.allowNzLeft)("nzColumnKey","id")("nzSortFn",!0)("nzSortDirections",t.DdM(83,Z))("nzSortOrder","ascend"),t.xp6(1),t.Oqu(t.lcZ(12,61,"ID")),t.xp6(2),t.Q6J("nzColumnKey","name")("nzSortFn",!0)("nzSortDirections",t.DdM(84,Z)),t.xp6(1),t.Oqu(t.lcZ(15,63,"NAME")),t.xp6(3),t.Oqu(t.lcZ(18,65,"IF")),t.xp6(3),t.Oqu(t.lcZ(21,67,"THEN")),t.xp6(2),t.Q6J("nzColumnKey","event")("nzSortFn",!0)("nzSortDirections",t.DdM(85,Z)),t.xp6(1),t.Oqu(t.lcZ(24,69,"SEND_EVENT")),t.xp6(2),t.Q6J("nzColumnKey","send_email")("nzSortFn",!0)("nzSortDirections",t.DdM(86,Z)),t.xp6(1),t.Oqu(t.lcZ(27,71,"EMAIL")),t.xp6(2),t.Q6J("nzColumnKey","raise_alarm")("nzSortFn",!0)("nzSortDirections",t.DdM(87,Z)),t.xp6(1),t.Oqu(t.lcZ(30,73,"ALARM")),t.xp6(2),t.Q6J("nzColumnKey","status")("nzSortFn",!0)("nzSortDirections",t.DdM(88,Z)),t.xp6(1),t.Oqu(t.lcZ(33,75,"STATUS")),t.xp6(3),t.Oqu(t.lcZ(36,77,"ACTION")),t.xp6(3),t.Q6J("nzLeft",e.allowNzLeft),t.xp6(1),t.Q6J("nzLeft",e.allowNzLeft),t.xp6(7),t.Q6J("options",o.yesNo)("showSearch",!1)("clearable",!0)("model",e.filtersModel.event),t.xp6(2),t.Q6J("options",o.yesNo)("showSearch",!1)("clearable",!0)("model",e.filtersModel.send_email),t.xp6(2),t.Q6J("options",o.yesNo)("showSearch",!1)("clearable",!0)("model",e.filtersModel.raise_alarm),t.xp6(2),t.Q6J("options",o.enableDisable)("showSearch",!1)("clearable",!0)("model",e.filtersModel.status),t.xp6(3),t.Q6J("ngForOf",n.data)("ngForTrackBy",o.trackByFun)}}function st(a,s){if(1&a&&(t.TgZ(0,"span"),t._UZ(1,"i",44),t._uU(2),t.ALo(3,"translate"),t.qZA()),2&a){const e=t.oxw().$implicit;t.xp6(2),t.Oqu(t.lcZ(3,1,e.variable||"-"))}}function rt(a,s){if(1&a&&(t.TgZ(0,"span"),t._UZ(1,"i",44),t._uU(2),t.ALo(3,"toUnit"),t.qZA()),2&a){const e=t.oxw().$implicit;t.xp6(2),t.AsE("",e.threshold," ",t.lcZ(3,2,e.unit),"")}}function lt(a,s){if(1&a&&(t.TgZ(0,"div",77),t.TgZ(1,"span",43),t._uU(2),t.ALo(3,"valueFromId"),t.qZA(),t.qZA()),2&a){const e=t.oxw(4);t.xp6(2),t.Oqu(t.Dn7(3,1,e.editAutomation.logical,e.logicals,"text"))}}function ct(a,s){if(1&a){const e=t.EpF();t.TgZ(0,"div"),t.TgZ(1,"div",77),t.TgZ(2,"span",43),t.TgZ(3,"span"),t._uU(4),t.qZA(),t.YNc(5,st,4,3,"span",3),t.TgZ(6,"span"),t._UZ(7,"i",44),t._uU(8),t.ALo(9,"valueFromId"),t.qZA(),t.YNc(10,rt,4,4,"span",3),t.TgZ(11,"span",78),t.NdJ("click",function(){const o=t.CHM(e),i=o.$implicit,l=o.index;return t.oxw(3).openConditionDrawer(i,l)}),t._UZ(12,"i",49),t.qZA(),t.TgZ(13,"span",78),t.NdJ("click",function(){const i=t.CHM(e).index;return t.oxw(3).removeCondition(i)}),t._UZ(14,"i",52),t.qZA(),t.qZA(),t.qZA(),t.YNc(15,lt,4,5,"div",67),t.qZA()}if(2&a){const e=s.$implicit,n=s.index,o=t.oxw(3);t.xp6(4),t.Oqu(e.device_name||"-"),t.xp6(1),t.Q6J("ngIf",4!==e.type&&5!==e.type),t.xp6(3),t.Oqu(t.Dn7(9,7,e.type,o.automationTypesAll,"text")),t.xp6(2),t.Q6J("ngIf",4!==e.type&&5!==e.type&&3!==e.type&&6!==e.type),t.xp6(1),t.MGl("id","edit_condition_button_",n,""),t.xp6(2),t.MGl("id","remove_condition_button_",n,""),t.xp6(2),t.Q6J("ngIf",0===n&&o.editAutomation.condition.length>1)}}function dt(a,s){if(1&a){const e=t.EpF();t.TgZ(0,"div",77),t.TgZ(1,"span",79),t.NdJ("click",function(){return t.CHM(e),t.oxw(3).openConditionDrawer()}),t._UZ(2,"i",2),t._uU(3),t.ALo(4,"translate"),t.qZA(),t.qZA()}2&a&&(t.xp6(3),t.Oqu(t.lcZ(4,1,"ADD_CONDITION")))}function _t(a,s){if(1&a){const e=t.EpF();t.TgZ(0,"div",62),t.TgZ(1,"div",70),t.TgZ(2,"label"),t._uU(3),t.ALo(4,"translate"),t.qZA(),t.TgZ(5,"div"),t.TgZ(6,"nz-switch",80),t.NdJ("ngModelChange",function(o){return t.CHM(e),t.oxw(3).editAutomation.status=o}),t.qZA(),t.TgZ(7,"span"),t._uU(8),t.ALo(9,"translate"),t.qZA(),t.qZA(),t.qZA(),t.qZA()}if(2&a){const e=t.oxw(3);t.xp6(3),t.Oqu(t.lcZ(4,3,"STATUS")),t.xp6(3),t.Q6J("ngModel",e.editAutomation.status),t.xp6(2),t.Oqu(t.lcZ(9,5,e.editAutomation.status?"ENABLED":"DISABLED"))}}function ut(a,s){if(1&a){const e=t.EpF();t.TgZ(0,"button",81),t.NdJ("appFormButtonClick",function(){return t.CHM(e),t.oxw(3).goToStepThen()}),t._uU(1),t.ALo(2,"translate"),t.qZA()}if(2&a){t.oxw();const e=t.MAs(6);t.Q6J("form",e),t.xp6(1),t.Oqu(t.lcZ(2,2,"NEXT_STEP"))}}function pt(a,s){if(1&a){const e=t.EpF();t.TgZ(0,"div",58),t.TgZ(1,"div",59),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"div",60),t.TgZ(5,"form",null,61),t.TgZ(7,"div",62),t.TgZ(8,"label",63),t._uU(9),t.ALo(10,"translate"),t.qZA(),t.TgZ(11,"app-validate",64),t.TgZ(12,"input",65,66),t.NdJ("ngModelChange",function(o){return t.CHM(e),t.oxw(2).editAutomation.name=o}),t.qZA(),t.qZA(),t.qZA(),t.TgZ(14,"div",62),t.TgZ(15,"label"),t._uU(16),t.ALo(17,"translate"),t.qZA(),t.YNc(18,ct,16,11,"div",42),t.YNc(19,dt,5,3,"div",67),t.qZA(),t.TgZ(20,"div",62),t.TgZ(21,"label"),t._uU(22),t.ALo(23,"translate"),t.qZA(),t.TgZ(24,"app-validate",64),t.TgZ(25,"nz-input-number",68,69),t.NdJ("ngModelChange",function(o){return t.CHM(e),t.oxw(2).editAutomation.time_delay=o}),t.qZA(),t.qZA(),t.qZA(),t.TgZ(27,"div",62),t.TgZ(28,"div",70),t.TgZ(29,"label"),t._uU(30),t.ALo(31,"translate"),t.qZA(),t.TgZ(32,"div"),t.TgZ(33,"nz-switch",71),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).resetAlarm()})("ngModelChange",function(o){return t.CHM(e),t.oxw(2).editAutomation.event=o}),t.qZA(),t.TgZ(34,"span"),t._uU(35),t.ALo(36,"translate"),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(37,"div",62),t.TgZ(38,"div",70),t.TgZ(39,"label"),t._uU(40),t.ALo(41,"translate"),t.qZA(),t.TgZ(42,"div"),t.TgZ(43,"nz-switch",72),t.NdJ("ngModelChange",function(o){return t.CHM(e),t.oxw(2).editAutomation.raise_alarm=o}),t.qZA(),t.TgZ(44,"span"),t._uU(45),t.ALo(46,"translate"),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(47,"div",62),t.TgZ(48,"div",70),t.TgZ(49,"label"),t._uU(50),t.ALo(51,"translate"),t.qZA(),t.TgZ(52,"div"),t.TgZ(53,"nz-switch",73),t.NdJ("ngModelChange",function(o){return t.CHM(e),t.oxw(2).editAutomation.send_email=o}),t.qZA(),t.TgZ(54,"span"),t._uU(55),t.ALo(56,"translate"),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.YNc(57,_t,10,7,"div",74),t.TgZ(58,"button",75),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).closeAutomationDrawer(!0)}),t._uU(59),t.ALo(60,"translate"),t.qZA(),t.YNc(61,ut,3,4,"button",76),t.qZA(),t.qZA(),t.qZA()}if(2&a){const e=t.MAs(13),n=t.MAs(26),o=t.oxw(2);t.xp6(2),t.hij(" ",t.lcZ(3,29,o.editAutomation.id?"EDIT_AUTOMATION_IF":"NEW_AUTOMATION_IF")," "),t.xp6(7),t.Oqu(t.lcZ(10,31,"NAME")),t.xp6(2),t.Q6J("field",e),t.xp6(1),t.Q6J("ngModel",o.editAutomation.name),t.xp6(4),t.Oqu(t.lcZ(17,33,"CONDITIONS")),t.xp6(2),t.Q6J("ngForOf",o.editAutomation.condition),t.xp6(1),t.Q6J("ngIf",o.editAutomation.condition.length<2),t.xp6(3),t.hij("",t.lcZ(23,35,"TIME_DELAY")," [s]"),t.xp6(2),t.Q6J("field",n),t.xp6(1),t.Q6J("ngModel",o.editAutomation.time_delay)("nzMin",0)("nzMax",2147483647)("nzStep",1)("required",!0)("nzDisabled",3===(null==o.editAutomation.condition[0]?null:o.editAutomation.condition[0].type)||3===(null==o.editAutomation.condition[1]?null:o.editAutomation.condition[1].type)),t.xp6(5),t.Oqu(t.lcZ(31,37,"SEND_EVENT")),t.xp6(3),t.Q6J("ngModel",o.editAutomation.event),t.xp6(2),t.Oqu(t.lcZ(36,39,o.editAutomation.event?"ENABLED":"DISABLED")),t.xp6(5),t.Oqu(t.lcZ(41,41,"ALARM")),t.xp6(3),t.Q6J("disabled",!o.editAutomation.event)("ngModel",o.editAutomation.raise_alarm),t.xp6(2),t.Oqu(t.lcZ(46,43,o.editAutomation.raise_alarm?"ENABLED":"DISABLED")),t.xp6(5),t.Oqu(t.lcZ(51,45,"EMAIL_NOTIFICATION")),t.xp6(3),t.Q6J("ngModel",o.editAutomation.send_email),t.xp6(2),t.Oqu(t.lcZ(56,47,o.editAutomation.send_email?"ENABLED":"DISABLED")),t.xp6(2),t.Q6J("ngIf",!o.editAutomation.id),t.xp6(1),t.uIk("id","drawer_cancel_button"),t.xp6(1),t.Oqu(t.lcZ(60,49,"CANCEL")),t.xp6(2),t.Q6J("ngIf",0===o.current)}}const f=function(){return{required:!0}};function mt(a,s){if(1&a){const e=t.EpF();t.TgZ(0,"div",62),t.TgZ(1,"label",63),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"app-select",89),t.NdJ("modelChange",function(o){return t.CHM(e),t.oxw(3).editAutomation.action.variable=o}),t.qZA(),t.qZA()}if(2&a){const e=t.oxw(3);t.xp6(2),t.Oqu(t.lcZ(3,4,"IoModule"===e.editAutomation.action.device_type||"MeterABB"===e.editAutomation.action.device_type_selected?"PORT":"REGISTER")),t.xp6(2),t.Q6J("model",e.editAutomation.action.variable)("options",e.actionVariables)("validators",t.DdM(6,f))}}function gt(a,s){if(1&a){const e=t.EpF();t.TgZ(0,"div",62),t.TgZ(1,"label",63),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"app-select",90),t.NdJ("modelChange",function(o){return t.CHM(e),t.oxw(3).editAutomation.action.value=o}),t.qZA(),t.qZA()}if(2&a){const e=t.oxw(3);t.xp6(2),t.Oqu(t.lcZ(3,4,"ACTION")),t.xp6(2),t.Q6J("model",e.editAutomation.action.value)("options",e.actions)("validators",t.DdM(6,f))}}function ht(a,s){if(1&a){const e=t.EpF();t.TgZ(0,"div",62),t.TgZ(1,"label",63),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"app-validate",64),t.TgZ(5,"input",91,92),t.NdJ("ngModelChange",function(o){return t.CHM(e),t.oxw(3).editAutomation.action.value=o}),t.qZA(),t.qZA(),t.qZA()}if(2&a){const e=t.MAs(6),n=t.oxw(3);t.xp6(2),t.Oqu(t.lcZ(3,3,"VALUE")),t.xp6(2),t.Q6J("field",e),t.xp6(1),t.Q6J("ngModel",n.editAutomation.action.value)}}function At(a,s){if(1&a){const e=t.EpF();t.TgZ(0,"div",58),t.TgZ(1,"span",82),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).goToStepIf()}),t._UZ(2,"i",83),t._uU(3),t.ALo(4,"translate"),t.qZA(),t.TgZ(5,"div",84),t._uU(6),t.ALo(7,"translate"),t.qZA(),t.TgZ(8,"div",60),t.TgZ(9,"form",null,61),t.TgZ(11,"div",62),t.TgZ(12,"label",63),t._uU(13),t.ALo(14,"translate"),t.qZA(),t.TgZ(15,"app-select",85),t.NdJ("modelChange",function(o){return t.CHM(e),t.oxw(2).editAutomation.action.device_type=o})("callbackChange",function(){return t.CHM(e),t.oxw(2).actionDeviceTypeChanged()}),t.qZA(),t.qZA(),t.TgZ(16,"div",62),t.TgZ(17,"label",63),t._uU(18),t.ALo(19,"translate"),t.qZA(),t.TgZ(20,"app-select",86),t.NdJ("modelChange",function(o){return t.CHM(e),t.oxw(2).editAutomation.action.object_id=o})("callbackChange",function(){return t.CHM(e),t.oxw(2).actionDeviceChanged()}),t.qZA(),t.qZA(),t.YNc(21,mt,5,7,"div",74),t.YNc(22,gt,5,7,"div",74),t.YNc(23,ht,7,5,"div",74),t.TgZ(24,"button",87),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).closeAutomationDrawer(!0)}),t._uU(25),t.ALo(26,"translate"),t.qZA(),t.TgZ(27,"button",88),t.NdJ("appFormButtonClick",function(){return t.CHM(e),t.oxw(2).saveAutomation()}),t._uU(28),t.ALo(29,"translate"),t.qZA(),t.qZA(),t.qZA(),t.qZA()}if(2&a){const e=t.MAs(10),n=t.oxw(2);t.xp6(3),t.Oqu(t.lcZ(4,19,"EDIT_IF_AUTOMATION")),t.xp6(3),t.hij(" ",t.lcZ(7,21,n.editAutomation.id?"EDIT_AUTOMATION_THEN":"NEW_AUTOMATION_THEN")," "),t.xp6(7),t.Oqu(t.lcZ(14,23,"DEVICE_TYPE")),t.xp6(2),t.Q6J("model",n.editAutomation.action.device_type)("options",n.actionDeviceTypes)("validators",t.DdM(31,f)),t.xp6(3),t.Oqu(t.lcZ(19,25,"DEVICE")),t.xp6(2),t.Q6J("model",n.editAutomation.action.object_id)("options",n.actionDevices)("validators",t.DdM(32,f)),t.xp6(1),t.Q6J("ngIf","ModAriArh"!==n.editAutomation.action.device_type),t.xp6(1),t.Q6J("ngIf","IoModule"===n.editAutomation.action.device_type||"ModAriArh"===n.editAutomation.action.device_type||"MeterABB"===n.editAutomation.action.device_type_selected),t.xp6(1),t.Q6J("ngIf","IoModule"!==n.editAutomation.action.device_type&&"ModAriArh"!==n.editAutomation.action.device_type&&"MeterABB"!==n.editAutomation.action.device_type_selected),t.xp6(1),t.uIk("id","drawer_cancel_button"),t.xp6(1),t.Oqu(t.lcZ(26,27,"CANCEL")),t.xp6(2),t.Q6J("nzLoading",n.saving)("disabled",n.saving)("form",e),t.xp6(1),t.Oqu(t.lcZ(29,29,n.editAutomation.id?"SAVE_AUTOMATION":"CREATE_AUTOMATION"))}}function Tt(a,s){if(1&a){const e=t.EpF();t.TgZ(0,"button",51),t.NdJ("click",function(){return t.CHM(e),t.oxw().closeAutomationDrawer()}),t._UZ(1,"i",52),t.qZA(),t.TgZ(2,"div",53),t.TgZ(3,"div",54),t.TgZ(4,"nz-steps",55),t._UZ(5,"nz-step",56),t._UZ(6,"nz-step",56),t.qZA(),t.qZA(),t.YNc(7,pt,62,51,"div",57),t.YNc(8,At,30,33,"div",57),t.qZA()}if(2&a){const e=t.oxw(),n=t.MAs(12),o=t.MAs(14);t.xp6(4),t.Q6J("nzCurrent",e.current),t.xp6(1),t.Q6J("nzIcon",n),t.xp6(1),t.Q6J("nzIcon",o),t.xp6(1),t.Q6J("ngIf",0===e.current),t.xp6(1),t.Q6J("ngIf",1===e.current)}}function Ct(a,s){if(1&a){const e=t.EpF();t.TgZ(0,"div",62),t.TgZ(1,"label",63),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"app-select",97),t.NdJ("modelChange",function(o){return t.CHM(e),t.oxw(2).editCondition.logical=o}),t.qZA(),t.qZA()}if(2&a){const e=t.oxw(2);t.xp6(2),t.Oqu(t.lcZ(3,4,"LOGICAL")),t.xp6(2),t.Q6J("model",e.editCondition.logical)("options",e.logicals)("validators",t.DdM(6,f))}}function vt(a,s){if(1&a){const e=t.EpF();t.TgZ(0,"div",62),t.TgZ(1,"label",63),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"app-select",98),t.NdJ("modelChange",function(o){return t.CHM(e),t.oxw(2).editCondition.category=o})("callbackChange",function(){return t.CHM(e),t.oxw(2).categoryChanged()}),t.qZA(),t.qZA()}if(2&a){const e=t.oxw(2);t.xp6(2),t.Oqu(t.lcZ(3,4,"CATEGORY")),t.xp6(2),t.Q6J("model",e.editCondition.category)("options",e.categories)("validators",t.DdM(6,f))}}function ft(a,s){if(1&a){const e=t.EpF();t.TgZ(0,"div",62),t.TgZ(1,"label",63),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"app-select",99),t.NdJ("modelChange",function(o){return t.CHM(e),t.oxw(2).editCondition.variable=o})("callbackChange",function(){return t.CHM(e),t.oxw(2).measureChanged()}),t.qZA(),t.qZA()}if(2&a){const e=t.oxw(2);t.xp6(2),t.Oqu(t.lcZ(3,4,"MEASURE")),t.xp6(2),t.Q6J("model",e.editCondition.variable)("options",e.variables)("validators",t.DdM(6,f))}}function xt(a,s){if(1&a){const e=t.EpF();t.TgZ(0,"div",62),t.TgZ(1,"label"),t._uU(2),t.ALo(3,"translate"),t.ALo(4,"toUnit"),t.qZA(),t.TgZ(5,"app-validate",64),t.TgZ(6,"nz-input-number",100,101),t.NdJ("ngModelChange",function(o){return t.CHM(e),t.oxw(2).editCondition.threshold=o}),t.qZA(),t.qZA(),t.qZA()}if(2&a){const e=t.MAs(7),n=t.oxw(2);t.xp6(2),t.AsE("",t.lcZ(3,8,"THRESHOLD")," ",t.lcZ(4,10,n.editCondition.unit)," "),t.xp6(3),t.Q6J("field",e),t.xp6(1),t.Q6J("ngModel",n.editCondition.threshold)("nzMin",0)("nzStep",.01)("nzMax",2147483647)("required",!0)}}const Mt=function(){return["ThirdPartyRTU","ThirdPartyTCP","MeterWMbus"]};function Lt(a,s){if(1&a){const e=t.EpF();t.TgZ(0,"button",51),t.NdJ("click",function(){return t.CHM(e),t.oxw().closeConditionDrawer()}),t._UZ(1,"i",52),t.qZA(),t.TgZ(2,"div",60),t.TgZ(3,"form",null,61),t.YNc(5,Ct,5,7,"div",74),t.TgZ(6,"div",62),t.TgZ(7,"label",63),t._uU(8),t.ALo(9,"translate"),t.qZA(),t.TgZ(10,"app-select",93),t.NdJ("modelChange",function(o){return t.CHM(e),t.oxw().editCondition.device_type=o})("callbackChange",function(){return t.CHM(e),t.oxw().deviceTypeChanged()}),t.qZA(),t.qZA(),t.TgZ(11,"div",62),t.TgZ(12,"label",63),t._uU(13),t.ALo(14,"translate"),t.qZA(),t.TgZ(15,"app-select",94),t.NdJ("modelChange",function(o){return t.CHM(e),t.oxw().editCondition.object_id=o})("callbackChange",function(){return t.CHM(e),t.oxw().deviceChanged()}),t.qZA(),t.qZA(),t.TgZ(16,"div",62),t.TgZ(17,"label",63),t._uU(18),t.ALo(19,"translate"),t.qZA(),t.TgZ(20,"app-select",95),t.NdJ("modelChange",function(o){return t.CHM(e),t.oxw().editCondition.type=o})("callbackChange",function(){return t.CHM(e),t.oxw().automationTypeChanged()}),t.qZA(),t.qZA(),t.YNc(21,vt,5,7,"div",74),t.YNc(22,ft,5,7,"div",74),t.YNc(23,xt,8,12,"div",74),t.TgZ(24,"button",96),t.NdJ("appFormButtonClick",function(){return t.CHM(e),t.oxw().addCondition()}),t._uU(25),t.ALo(26,"translate"),t.qZA(),t.qZA(),t.qZA()}if(2&a){const e=t.MAs(4),n=t.oxw();t.xp6(5),t.Q6J("ngIf",n.editAutomation.condition.length>0&&0!==n.editCondition.index),t.xp6(3),t.Oqu(t.lcZ(9,17,"DEVICE_TYPE")),t.xp6(2),t.Q6J("model",n.editCondition.device_type)("options",n.deviceTypes)("validators",t.DdM(25,f)),t.xp6(3),t.Oqu(t.lcZ(14,19,"DEVICE")),t.xp6(2),t.Q6J("model",n.editCondition.object_id)("options",n.automationDevices)("validators",t.DdM(26,f)),t.xp6(3),t.Oqu(t.lcZ(19,21,"TYPE")),t.xp6(2),t.Q6J("model",n.editCondition.type)("options",n.automationTypes),t.xp6(1),t.Q6J("ngIf",4!==n.editCondition.type&&5!==n.editCondition.type&&n.editCondition.device_type&&t.DdM(27,Mt).includes(n.editCondition.device_type)),t.xp6(1),t.Q6J("ngIf",4!==n.editCondition.type&&5!==n.editCondition.type),t.xp6(1),t.Q6J("ngIf",n.editCondition.type<3),t.xp6(1),t.Q6J("form",e),t.xp6(1),t.Oqu(t.lcZ(26,23,n.editCondition.index?"SAVE":"ADD"))}}function Zt(a,s){1&a&&(t.TgZ(0,"span",102),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&a&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"IF")))}function bt(a,s){1&a&&(t.TgZ(0,"span",103),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&a&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"THEN")))}let Et=(()=>{class a{constructor(e,n,o,i,l){this.translate=e,this.toastr=n,this.modalService=o,this.automationsService=i,this.drawerService=l,this.id="load_management_automations",this.loadingData=!0,this.saving=!1,this.noStringVariablesArray=[],this.current=0,this.editMode=!1}ngOnInit(){this.getData(),this.deviceTypes=[{id:"CurrentSensor",text:"CURRENT_SENSORS"},{id:"IoModule",text:"IO_MODULES"},{id:"AuxiliaryContact",text:"SSD"},{id:"ThirdPartyRTU",text:"MODBUS_RTU_DEVICES"},{id:"ThirdPartyTCP",text:"MODBUS_TCP_DEVICES"},{id:"MeterWMbus",text:"WIRELESS_MBUS_METERS"},{id:"Group",text:"GROUPS"}],this.yesNo=[{id:0,text:"NO"},{id:1,text:"YES"}],this.logicals=[{id:"and",text:"AND"},{id:"or",text:"OR"}],this.enableDisable=[{id:0,text:"DISABLED"},{id:1,text:"ENABLED"}],this.automationTypesAll=C.uS,this.actions=[{id:0,text:"OPEN"},{id:1,text:"CLOSE"}]}getData(){this.loadingData=!0,this.automationsService.getAutomationsConfiguration().subscribe(e=>{this.rows=e.automations,this.devices=e.devices,this.ioModules=e.ioModules,this.rows.forEach(n=>{var o;const i=this.devices.find(l=>n.action.object_id===l.object_id);if(i)if(n.action.device_name=i.name,"IoModule"===i.device_type){const l=this.ioModules.find(u=>n.action.object_id===u.object_id);if(l){const u=null===(o=n.action.variable)||void 0===o?void 0:o.match(/\d+/)[0],g=l.ports.find(L=>L.port===Number(u));g&&(n.action.variable_name=g.name)}else n.action.object_id=null,n.action.variable=null}else"ModAriArh"===i.device_type?65280===n.action.value&&(n.action.value=1):n.action.variable_name=this.translate.instant(n.action.variable||"");else n.action.object_id=null,n.action.variable=null;n.condition.forEach(l=>{const u=this.devices.find(g=>l.object_id===g.object_id);if(u){if(l.device_name=u.name,l.device_type="MeterABB"===u.device_type?"ThirdPartyRTU":u.device_type,u.variables){const g=u.variables.find(L=>l.variable===L.variable);g&&(l.unit=g.unit)}}else l.variable=null})}),this.loadingData=!1},()=>{this.toastr.error(this.translate.instant("REQUEST_ERROR"))})}trackByFun(e,n){return n.id}toggleStatus(e){let n;n=e.status?"disable":"enable";const o=this.rows,i=this.rows.findIndex(u=>u.id===e.id);o[i].status=o[i].status=Number(!o[i].status),this.modalService.showConfirm(this.translate.instant(e.status?"AUTOMATION_DISABLE":"AUTOMATION_ENABLE",{name:"<strong>"+e.name+"</strong>"}),()=>{this.modalService.setLoading(!0),e.status=Number(!e.status),this.automationsService.toggleAutomationStatus([e.id],n).subscribe(()=>{this.toastr.success(this.translate.instant(e.status?"AUTOMATION_ENABLE_CONFIRM_SUCCESS":"AUTOMATION_DISABLE_CONFIRM_SUCCESS",{name:"<strong>"+e.name+"</strong>"})),this.modalService.hide()},()=>{this.toastr.error(this.translate.instant("REQUEST_ERROR")),this.modalService.hide()})})}removeAllSelected(e){const n=[];let o,i,l;e.tableData.forEach(u=>{u.selected&&n.push(u.id)}),n.length>1?(o=this.translate.instant("AUTOMATION_REMOVE_ALL"),i=this.translate.instant("AUTOMATION_REMOVE_ALL_SUCCESS")):(l=this.rows.findIndex(u=>u.id===n[0]),o=this.translate.instant("AUTOMATION_REMOVE",{name:"<strong>"+this.rows[l].name+"</strong>"}),i=this.translate.instant("AUTOMATION_REMOVE_SUCCESS",{name:"<strong>"+this.rows[l].name+"</strong>"})),this.modalService.showConfirm(o,()=>{this.modalService.setLoading(!0),this.automationsService.remove(n).subscribe(()=>{this.modalService.hide(),this.getData(),this.toastr.success(i)},()=>{this.toastr.error(this.translate.instant("REQUEST_ERROR")),this.modalService.hide()})})}toggleEnableDisable(e,n){const o=[];let i,l,u;e.tableData.forEach(g=>{g.selected&&o.push(g.id)}),o.length>1?(i=this.translate.instant("AUTOMATION_CHANGE_STATUS_ALL",{action:"<strong>"+n+"</strong>"}),l=this.translate.instant("AUTOMATION_STATUS_CHANGE_CONFIRM_SUCCESS_ALL",{action:"<strong>"+n+"d</strong>"})):(u=this.rows.findIndex(g=>g.id===o[0]),i=this.translate.instant("AUTOMATION_STATUS_CHANGE",{name:"<strong>"+this.rows[u].name+"</strong>",action:"<strong>"+n+"</strong>"}),l=this.translate.instant("AUTOMATION_STATUS_CHANGE_CONFIRM_SUCCESS",{name:"<strong>"+this.rows[u].name+"</strong>",action:"<strong>"+n+"d</strong>"})),this.modalService.showConfirm(this.translate.instant(i),()=>{this.modalService.setLoading(!0),this.automationsService.toggleAutomationStatus(o,n).subscribe(()=>{const g=this.rows;g.forEach(L=>L.selected=!1),o.forEach(L=>{const w=this.rows.findIndex(le=>le.id===L);g[w].selected=!0,g[w].status="enable"===n?1:0,this.rows=[...g]}),this.toastr.success(this.translate.instant(l)),this.modalService.hide()},()=>{this.toastr.error(this.translate.instant("REQUEST_ERROR")),this.modalService.hide()})})}saveAutomation(){let e,n;this.saving=!0,this.editMode=!1;const o={id:this.editAutomation.id,name:this.editAutomation.name,status:this.editAutomation.status,logical:this.editAutomation.logical,condition:this.editAutomation.condition.map(i=>({object_id:i.object_id,variable:i.variable,type:i.type,threshold:i.threshold})),action:{object_id:this.editAutomation.action.object_id,variable:this.editAutomation.action.variable,value:this.editAutomation.action.value},event:this.editAutomation.event,raise_alarm:this.editAutomation.raise_alarm,time_delay:this.editAutomation.time_delay,send_email:this.editAutomation.send_email};"ModAriArh"===this.editAutomation.action.device_type&&(o.action.variable="circuitBreakerCommand",o.action.value=0===this.editAutomation.action.value?0:65280),this.editAutomation.id?(n="AUTOMATION_EDIT_SUCCESS",e=this.automationsService.setAutomation(o)):(n="AUTOMATION_ADD_SUCCESS",e=this.automationsService.saveAutomation(o)),e.subscribe(()=>{this.toastr.success(this.translate.instant(n,{name:"<strong>"+this.editAutomation.name+"</strong>"})),this.getData(),this.closeAutomationDrawer(),this.saving=!1},()=>{this.toastr.error(this.translate.instant("REQUEST_ERROR")),this.saving=!1}),this.tempAutomation=null}deviceTypeChanged(){this.editCondition.object_id=null,this.editCondition.category=null,this.editCondition.variable=null,this.categories=[],this.checkAutomationDevices(),this.checkAutomationTypes(),this.checkVariables()}checkCategories(){if(this.editCondition.object_id){if(this.editCondition.device_type&&["ThirdPartyRTU","ThirdPartyTCP","MeterWMbus"].includes(this.editCondition.device_type)){const e=[],n=this.devices.find(o=>this.editCondition.object_id===o.object_id);n&&n.variables.filter(o=>o.hasOwnProperty("address")||o.hasOwnProperty("dif")).forEach(o=>{e.find(l=>l.id===o.category)||e.push({id:o.category,text:o.category})}),this.categories=e}this.checkVariables()}}checkAutomationTypes(){this.automationTypes=[this.automationTypesAll[1],this.automationTypesAll[2]],"IoModule"!==this.editCondition.device_type&&"AuxiliaryContact"!==this.editCondition.device_type&&[3,6,7].includes(this.editCondition.type)&&(this.editCondition.type=1),"Group"===this.editCondition.device_type&&[4,5].includes(this.editCondition.type)&&(this.editCondition.type=1),("IoModule"===this.editCondition.device_type||"AuxiliaryContact"===this.editCondition.device_type)&&this.automationTypes.push(this.automationTypesAll[3],this.automationTypesAll[6],this.automationTypesAll[7]),"Group"!==this.editCondition.device_type&&this.automationTypes.push(this.automationTypesAll[4],this.automationTypesAll[5])}checkAutomationDevices(){const e=[this.editCondition.device_type];"ThirdPartyRTU"===this.editCondition.device_type&&e.push("MeterABB"),this.automationDevices=this.devices.filter(n=>e.includes(n.device_type)).map(n=>({id:n.object_id,name:n.name}))}checkAutomationActionDevices(){if("IoModule"===this.editAutomation.action.device_type)this.actionDevices=this.ioModules.map(e=>({id:e.object_id,name:e.name}));else if("ModAriArh"===this.editAutomation.action.device_type)this.actionDevices=this.devices.filter(e=>"ModAriArh"===e.device_type).map(e=>({id:e.object_id,name:e.name}));else{const e=[this.editAutomation.action.device_type];"ThirdPartyRTU"===this.editAutomation.action.device_type&&e.push("MeterABB"),this.actionDevices=this.devices.filter(n=>e.includes(n.device_type)&&n.variables&&n.variables.some(o=>o.writable)).map(n=>({id:n.object_id,name:n.name}))}this.checkAutomationActionVariables()}checkAutomationActionDeviceTypes(){this.actionDeviceTypes=[{id:"IoModule",text:"IO_MODULES"},{id:"ModAriArh",text:"MOD"}],this.devices.some(n=>("ThirdPartyRTU"===n.device_type||"MeterABB"===n.device_type)&&n.variables&&n.variables.some(o=>o.writable))&&this.actionDeviceTypes.push({id:"ThirdPartyRTU",text:"MODBUS_RTU_DEVICES"}),this.devices.some(n=>"ThirdPartyTCP"===n.device_type&&n.variables&&n.variables.some(o=>o.writable))&&this.actionDeviceTypes.push({id:"ThirdPartyTCP",text:"MODBUS_TCP_DEVICES"});const e=this.devices.find(n=>n.object_id===this.editAutomation.action.object_id);e&&(this.editAutomation.action.device_type="MeterABB"===e.device_type?"ThirdPartyRTU":e.device_type,this.editAutomation.action.device_type_selected=e.device_type),this.checkAutomationActionDevices()}actionDeviceTypeChanged(){this.editAutomation.action.object_id=null,this.editAutomation.action.variable=null,this.editAutomation.action.value=null,this.checkAutomationActionDevices()}deviceChanged(){this.editCondition.category=null,this.editCondition.variable=null,this.checkCategories()}actionDeviceChanged(){this.editAutomation.action.variable=null;const e=this.devices.find(n=>n.object_id===this.editAutomation.action.object_id);e&&(this.editAutomation.action.device_type_selected=e.device_type),this.checkAutomationActionVariables()}checkAutomationActionVariables(){if("IoModule"===this.editAutomation.action.device_type){const e=this.ioModules.find(n=>{var o,i;return n.object_id===(null===(i=null===(o=this.editAutomation)||void 0===o?void 0:o.action)||void 0===i?void 0:i.object_id)});e&&(this.actionVariables=e.ports.map(n=>({id:`port${n.port}StateCoil`,name:n.name})))}else if("ModAriArh"!==this.editAutomation.action.device_type){const e=this.devices.find(n=>{var o,i;return n.object_id===(null===(i=null===(o=this.editAutomation)||void 0===o?void 0:o.action)||void 0===i?void 0:i.object_id)});e&&(this.actionVariables=e.variables.filter(n=>n.writable).map(n=>({id:n.variable,name:n.variable})))}}automationTypeChanged(){("IoModule"===this.editCondition.device_type||"AuxiliaryContact"===this.editCondition.device_type)&&(this.checkVariables(),this.variables.find(n=>n.id===this.editCondition.variable)||(this.editCondition.variable=null))}categoryChanged(){this.editCondition.variable=null,this.checkVariables()}checkVariables(){if("CurrentSensor"===this.editCondition.device_type)this.variables=[{id:"currentTrms",text:"TRMS",unit_name:"A"},{id:"currentAc",text:"AC",unit_name:"A"},{id:"currentDc",text:"DC",unit_name:"A"},{id:"activePowerTotal",text:"ACTIVE_POWER",unit_name:"W"},{id:"activeEnergyImportTotal",text:"ENERGY",unit_name:"kWh"}];else if("IoModule"===this.editCondition.device_type){this.variables=[];const e=[],n=[],o=[];for(let i=1;i<=4;i++)e.push({id:`port${i}PulseCounterAccumulated`,text:this.translate.instant("PULSE_COUNTER")+" "+this.translate.instant("PORT")+" "+i}),n.push({id:`port${i}State`,text:this.translate.instant("TYPE_STATUS_CHANGE")+" "+this.translate.instant("PORT")+" "+i}),o.push({id:`port${i}PulseValue`,text:this.translate.instant("PULSE_VALUE")+" "+this.translate.instant("PORT")+" "+i});[1,2].includes(this.editCondition.type)?this.variables=[...e,...o]:[3,6,7].includes(this.editCondition.type)&&(this.variables=[...n])}else if("AuxiliaryContact"===this.editCondition.device_type){this.variables=[];const e=[],n=[],o=[{id:"inputVoltage",text:this.translate.instant("INPUT_VOLTAGE"),unit_name:"V"}];for(let i=1;i<=2;i++)n.push({id:`switch${i}`,text:this.translate.instant("SWITCH")+i});for(let i=1;i<=4;i++)e.push({id:`temperature${i}`,text:this.translate.instant("TEMPERATURE")+i,unit_name:"C"});[1,2].includes(this.editCondition.type)?this.variables=[...e,...o]:[3,6,7].includes(this.editCondition.type)&&(this.variables=[...n])}else if(this.editCondition.device_type&&["ThirdPartyRTU","ThirdPartyTCP","MeterWMbus"].includes(this.editCondition.device_type)){const e=[],n=this.devices.find(o=>this.editCondition.object_id===o.object_id);n&&n.variables.filter(o=>o.category===this.editCondition.category).forEach(o=>{!e.find(l=>l.id===o.variable)&&"string"!==o.dataType&&e.push({id:o.variable,text:o.variable,unit_name:o.unit})}),this.variables=e}else if(this.editCondition.device_type&&["Group"].includes(this.editCondition.device_type)){const e=[],n=this.devices.find(o=>this.editCondition.object_id===o.object_id);n&&n.variables.forEach(o=>{e.find(l=>l.id===o.variable)||e.push({id:o.variable,text:o.variable})}),this.variables=e}else this.variables=[];this.measureChanged()}goToStepIf(){this.current=0}goToStepThen(){this.current=1}openAutomationDrawer(e){this.toastr.clear(),this.current=0,this.actionVariables=[],this.editMode&&!e?this.editAutomation=this.tempAutomation:e?this.editAutomation=Object.assign(Object.assign({},e),{condition:[...e.condition],action:Object.assign({},e.action)}):(this.editAutomation={send_email:0,raise_alarm:0,event:0,time_delay:0,status:1,logical:"and",action:{device_type:"IoModule",object_id:null,variable:null,value:null},condition:[]},this.tempAutomation=this.editAutomation),this.checkAutomationActionDeviceTypes(),this.drawerService.showDrawer(this.addAutomationDrawer).subscribe(n=>{this.editMode=!!this.tempAutomation})}closeAutomationDrawer(e){this.drawerService.hide(),this.editMode=!!this.tempAutomation,e&&(this.tempAutomation={send_email:0,raise_alarm:0,event:0,time_delay:0,status:1,logical:"and",action:{device_type:"IoModule",object_id:null,variable:null,value:null},condition:[]})}openConditionDrawer(e,n){if(e){let o=null;if(e.device_type&&["ThirdPartyRTU","ThirdPartyTCP","MeterWMbus"].includes(e.device_type)&&e.object_id){const i=this.devices.find(l=>e.object_id===l.object_id);i&&i.variables.filter(l=>l.variable===e.variable).forEach(l=>{o||(o=l.category)})}this.editCondition=Object.assign(Object.assign({},e),{index:n,logical:this.editAutomation.logical,category:o})}else this.editCondition={device_type:"CurrentSensor",type:1,logical:"and",threshold:0};this.checkAutomationDevices(),this.checkCategories(),this.checkAutomationTypes(),this.drawerService.showSecondDrawer(this.addConditionDrawer)}closeConditionDrawer(){this.drawerService.hideSecond()}addCondition(){const e=this.devices.find(n=>this.editCondition.object_id===n.object_id);e&&(this.editCondition.device_name=e.name),(1===this.editCondition.index||1===this.editAutomation.condition.length)&&(this.editAutomation.logical=String(this.editCondition.logical)),void 0!==this.editCondition.index&&this.editCondition.index>=0?this.editAutomation.condition[this.editCondition.index]=this.editCondition:this.editAutomation.condition.push(Object.assign({},this.editCondition)),3===this.editCondition.type&&(this.editAutomation.time_delay=0),this.closeConditionDrawer()}removeCondition(e){this.editAutomation.condition.splice(e,1)}resetAlarm(){this.editAutomation.raise_alarm=0}measureChanged(){const e=this.variables.find(n=>n.id===this.editCondition.variable);this.editCondition.unit=e?e.unit_name:""}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(d.sK),t.Y36(m._),t.Y36(c.Z),t.Y36(v),t.Y36(x.z))},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-load-management-automations"]],viewQuery:function(e,n){if(1&e&&(t.Gf(Y,5),t.Gf(j,5)),2&e){let o;t.iGM(o=t.CRH())&&(n.addAutomationDrawer=o.first),t.iGM(o=t.CRH())&&(n.addConditionDrawer=o.first)}},hostVars:1,hostBindings:function(e,n){2&e&&t.uIk("id",n.id)},decls:15,vars:5,consts:[[1,"section-header"],["nz-button","","nzType","primary","id","add_new_automation_button",3,"click"],[1,"icon_abb_16","icon-abb_plus_16"],[4,"ngIf"],["class","section-content",4,"ngIf"],["addAutomationDrawer",""],["addConditionDrawer",""],["ifRef",""],["thenRef",""],[1,"section-content"],[3,"initSort","data"],["table",""],["class","table-selected-buttons",4,"ngIf"],["nzTableLayout","fixed",3,"nzData","nzFrontPagination","nzScroll","nzNoResult"],["nzTable",""],[3,"nzSortOrderChange"],["id","table_all_selected","nzWidth","60px",3,"nzLeft","nzChecked","nzIndeterminate","nzCheckedChange"],["nzWidth","60px",3,"nzLeft","nzColumnKey","nzSortFn","nzSortDirections","nzSortOrder"],["nzWidth","200px",3,"nzColumnKey","nzSortFn","nzSortDirections"],["nzWidth","300px"],["nzWidth","120px",3,"nzColumnKey","nzSortFn","nzSortDirections"],["nzWidth","150px","nzWidth","150px",3,"nzColumnKey","nzSortFn","nzSortDirections"],["nzWidth","80px"],[1,"filters"],[3,"nzLeft"],[1,"input",3,"nzLeft"],["type","text",3,"input"],[1,"input"],["inputId","event_filter","inputClass","no-validate",3,"options","showSearch","clearable","model","modelChange","callbackChange"],["inputId","send_email_filter","inputClass","no-validate",3,"options","showSearch","clearable","model","modelChange","callbackChange"],["inputId","raise_alarm_filter","inputClass","no-validate",3,"options","showSearch","clearable","model","modelChange","callbackChange"],["inputId","status_filter","inputClass","no-validate",3,"options","showSearch","clearable","model","modelChange","callbackChange"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"table-selected-buttons"],["id","table_nr_of_selected"],["nz-button","","nzType","primary","id","table_selected_remove_button",1,"black",3,"click"],[1,"icon_abb_16","icon-abb_trash_16"],["nz-button","","nzType","default","id","table_selected_enable_button",3,"click"],[1,"enable-icon-button"],["nz-button","","nzType","text","id","table_selected_disable_button",3,"click"],[1,"disable-icon-button"],[3,"id","nzLeft","nzChecked","nzCheckedChange"],[4,"ngFor","ngForOf"],[1,"tag"],[1,"icon_abb_16","icon-abb_right-arrow_16"],["nzEllipsis",""],["nzSize","small","name","status",3,"nzControl","ngModel","ngModelChange","click"],[1,"icons"],["nz-button","","nzTooltipPlacement","left","nz-tooltip","",3,"id","nzTooltipTitle","click"],[1,"icon_abb_16","icon-abb_edit_16"],["class","tag",4,"ngIf"],["tabIndex","-1","nz-button","",1,"drawer-button-close",3,"click"],[1,"icon_abb_16","icon-abb_close_16"],[1,"drawer-steps-container"],[1,"drawer-steps"],["nzDirection","vertical",1,"drawer-steps",3,"nzCurrent"],[3,"nzIcon"],["class","drawer-steps-content",4,"ngIf"],[1,"drawer-steps-content"],[1,"drawer-title","text-line"],[1,"drawer-body"],["formAdd","ngForm"],[1,"form-group"],[1,"label-required"],[3,"field"],["type","text","maxlength","255","id","automation_name_input","name","automationName","required","",3,"ngModel","ngModelChange"],["automationName","ngModel"],["class","tag-row",4,"ngIf"],["name","timeDelayInput","id","time_delay_input_wrapper","nzId","time_delay_input",3,"ngModel","nzMin","nzMax","nzStep","required","nzDisabled","ngModelChange"],["timeDelayInput","ngModel"],[1,"switch-label-container"],["nzSize","small","id","send_event_switch","name","eventSwitch",3,"ngModel","click","ngModelChange"],["nzSize","small","id","raise_alarm_switch","name","raiseAlarmSwitch",3,"disabled","ngModel","ngModelChange"],["nzSize","small","id","send_email_switch","name","sendEmailSwitch",3,"ngModel","ngModelChange"],["class","form-group",4,"ngIf"],["type","button","nz-button","",3,"click"],["type","submit","nz-button","","nzType","primary","class","drawer-step-next","id","next_step",3,"form","appFormButtonClick",4,"ngIf"],[1,"tag-row"],[1,"tag-icon",3,"id","click"],["id","add_condition_button",1,"tag","add-new",3,"click"],["nzSize","small","id","status_switch","name","statusSwitch",3,"ngModel","ngModelChange"],["type","submit","nz-button","","nzType","primary","id","next_step",1,"drawer-step-next",3,"form","appFormButtonClick"],["id","previous_step",1,"drawer-step-go-back",3,"click"],[1,"icon_abb_16","icon-abb_left-arrow_16"],[1,"drawer-title"],["inputId","action_device_type_select",3,"model","options","validators","modelChange","callbackChange"],["inputId","automation_action_device_select",3,"model","options","validators","modelChange","callbackChange"],["nz-button","",3,"click"],["type","submit","id","save_automation_button","nz-button","","nzType","primary",1,"drawer-step-next",3,"nzLoading","disabled","form","appFormButtonClick"],["inputId","automation_action_port_select",3,"model","options","validators","modelChange"],["inputId","automation_action_value_select",3,"model","options","validators","modelChange"],["type","text","maxlength","255","id","automation_action_value_input","name","automationValue","required","",3,"ngModel","ngModelChange"],["automationValue","ngModel"],["inputId","device_type_select",3,"model","options","validators","modelChange","callbackChange"],["inputId","automation_device_select",3,"model","options","validators","modelChange","callbackChange"],["inputId","type_select",3,"model","options","modelChange","callbackChange"],["type","submit","nz-button","","nzType","primary","id","add_condition",1,"drawer-step-next",3,"form","appFormButtonClick"],["inputId","logical_type_select",3,"model","options","validators","modelChange"],["inputId","category_select",3,"model","options","validators","modelChange","callbackChange"],["inputId","variable_select",3,"model","options","validators","modelChange","callbackChange"],["name","thresholdInput","id","threshold_input_wrapper","nzId","threshold_input",3,"ngModel","nzMin","nzStep","nzMax","required","ngModelChange"],["thresholdInput","ngModel"],[1,"ant-steps-step"],[1,"ant-steps-step","line"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0),t.TgZ(1,"button",1),t.NdJ("click",function(){return n.openAutomationDrawer()}),t._UZ(2,"i",2),t._uU(3),t.ALo(4,"translate"),t.qZA(),t.qZA(),t.YNc(5,W,1,0,"app-loader",3),t.YNc(6,it,56,89,"div",4),t.YNc(7,Tt,9,5,"ng-template",null,5,t.W1O),t.YNc(9,Lt,27,28,"ng-template",null,6,t.W1O),t.YNc(11,Zt,3,3,"ng-template",null,7,t.W1O),t.YNc(13,bt,3,3,"ng-template",null,8,t.W1O)),2&e&&(t.xp6(3),t.Oqu(t.lcZ(4,3,"ADD_NEW_AUTOMATION")),t.xp6(2),t.Q6J("ngIf",n.loadingData),t.xp6(1),t.Q6J("ngIf",!n.loadingData))},directives:[E.ix,I.dQ,D.w,M.O5,y.R,z.a,_.N8,_.Om,_.$Z,_.Uo,_._C,_.qn,_.g6,_.qD,J.H,_.p0,M.sg,_.h7,_.ky,q.i,T.JJ,T.On,H.SY,U.iy,U.$W,T._Y,T.JL,T.F,F.P,T.Fj,T.nD,T.Q7,Q._,V.b],pipes:[d.X$,R.h,B.Z],styles:[".section-content[_ngcontent-%COMP%]{overflow:hidden;padding-bottom:0}#scheduler_switch[_ngcontent-%COMP%]{margin-right:5px}#add_button[_ngcontent-%COMP%]{margin-top:10px}"]}),a})();var S=r(7618),O=r(868);function yt(a,s){1&a&&(t.TgZ(0,"a",4),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&a&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"IO_MODULES")," "))}function St(a,s){1&a&&(t.TgZ(0,"a",5),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&a&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"MOD")," "))}let Ot=(()=>{class a{constructor(){this.id="load_management_control"}ngOnInit(){}}return a.\u0275fac=function(e){return new(e||a)},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-load-management-control"]],hostVars:1,hostBindings:function(e,n){2&e&&t.uIk("id",n.id)},decls:6,vars:1,consts:[["nzType","card","nzLinkRouter","",3,"nzAnimated"],["id","menu_load_management_control_io_modules","nz-tab-link","","routerLink","/load-management/control/io-modules",4,"nzTabLink"],["id","menu_load_management_control_mod","nz-tab-link","","routerLink","/load-management/control/mod",4,"nzTabLink"],[1,"router-outlet"],["id","menu_load_management_control_io_modules","nz-tab-link","","routerLink","/load-management/control/io-modules"],["id","menu_load_management_control_mod","nz-tab-link","","routerLink","/load-management/control/mod"]],template:function(e,n){1&e&&(t.TgZ(0,"nz-tabset",0),t.TgZ(1,"nz-tab"),t.YNc(2,yt,3,3,"a",1),t.qZA(),t.TgZ(3,"nz-tab"),t.YNc(4,St,3,3,"a",2),t.qZA(),t.qZA(),t._UZ(5,"router-outlet",3)),2&e&&t.Q6J("nzAnimated",!1)},directives:[O.xH,O.xw,O.Fx,O.Ao,p.yS,p.lC],pipes:[d.X$],encapsulation:2}),a})();var Nt=r(6625),P=r(6093),k=r(7420);function It(a,s){1&a&&t._UZ(0,"app-loader")}function Dt(a,s){1&a&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&a&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"OPEN")))}function zt(a,s){1&a&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&a&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"CLOSE")))}function qt(a,s){1&a&&(t.TgZ(0,"span"),t._uU(1,"-"),t.qZA())}function wt(a,s){if(1&a){const e=t.EpF();t.TgZ(0,"nz-switch",17),t.NdJ("ngModelChange",function(o){return t.CHM(e),t.oxw().$implicit.status=o})("click",function(){t.CHM(e);const o=t.oxw().$implicit,i=t.oxw().$implicit;return t.oxw(2).changeStatus(i,o)}),t.qZA()}if(2&a){const e=t.oxw().$implicit,n=t.oxw().index;t.MGl("id","change_status_",n,""),t.MGl("name","changeStatus_",n,""),t.Q6J("nzControl",!0)("ngModel",e.status)}}function Ut(a,s){1&a&&(t.TgZ(0,"span"),t._uU(1,"-"),t.qZA())}function Rt(a,s){if(1&a&&(t.TgZ(0,"tr"),t.TgZ(1,"td",14),t._uU(2),t.qZA(),t.TgZ(3,"td",14),t._uU(4),t.qZA(),t.TgZ(5,"td"),t._uU(6),t.qZA(),t.TgZ(7,"td"),t._uU(8),t.ALo(9,"valueFromId"),t.qZA(),t.TgZ(10,"td"),t._uU(11),t.ALo(12,"valueFromId"),t.qZA(),t.TgZ(13,"td"),t.YNc(14,Dt,3,3,"span",0),t.YNc(15,zt,3,3,"span",0),t.YNc(16,qt,2,0,"span",0),t.qZA(),t.TgZ(17,"td"),t.YNc(18,wt,1,4,"nz-switch",16),t.YNc(19,Ut,2,0,"span",0),t.qZA(),t.qZA()),2&a){const e=s.$implicit,n=t.oxw().$implicit;t.oxw();const o=t.MAs(2),i=t.oxw();t.xp6(1),t.Q6J("nzLeft",o.allowNzLeft),t.xp6(1),t.Oqu(n.modbus_id||"-"),t.xp6(1),t.Q6J("nzLeft",o.allowNzLeft),t.xp6(1),t.Oqu(e.port),t.xp6(2),t.Oqu(e.name),t.xp6(2),t.Oqu(t.xi3(9,12,e.connected_device_type,i.deviceTypes)),t.xp6(3),t.Oqu(t.xi3(12,15,e.connected_accessory_type,i.accessoryTypes)),t.xp6(3),t.Q6J("ngIf",0===e.status),t.xp6(1),t.Q6J("ngIf",1===e.status),t.xp6(1),t.Q6J("ngIf","-"===e.status),t.xp6(2),t.Q6J("ngIf","-"!==e.status),t.xp6(1),t.Q6J("ngIf","-"===e.status)}}function Pt(a,s){if(1&a&&(t.ynx(0),t.YNc(1,Rt,20,18,"tr",15),t.BQk()),2&a){const e=s.$implicit;t.xp6(1),t.Q6J("ngForOf",e.ports)}}const kt=function(){return{key:"modbus_id",value:"ascend"}},Jt=function(a,s){return{x:a,y:s}},Ht=function(){return["ascend","descend"]};function Ft(a,s){if(1&a){const e=t.EpF();t.TgZ(0,"div",2),t.TgZ(1,"app-table",3,4),t.TgZ(3,"nz-table",5,6),t.ALo(5,"translate"),t.TgZ(6,"thead",7),t.NdJ("nzSortOrderChange",function(o){return t.CHM(e),t.MAs(2).sort(o)}),t.TgZ(7,"tr"),t.TgZ(8,"th",8),t._uU(9),t.ALo(10,"translate"),t.qZA(),t.TgZ(11,"th",9),t._uU(12),t.ALo(13,"translate"),t.qZA(),t.TgZ(14,"th"),t._uU(15),t.ALo(16,"translate"),t.qZA(),t.TgZ(17,"th"),t._uU(18),t.ALo(19,"translate"),t.qZA(),t.TgZ(20,"th"),t._uU(21),t.ALo(22,"translate"),t.qZA(),t.TgZ(23,"th"),t._uU(24),t.ALo(25,"translate"),t.qZA(),t.TgZ(26,"th",10),t._uU(27),t.ALo(28,"translate"),t.qZA(),t.qZA(),t.TgZ(29,"tr",11),t.TgZ(30,"th",12),t.TgZ(31,"input",13),t.NdJ("input",function(o){return t.CHM(e),t.MAs(2).filter(o,"modbus_id","contains")}),t.qZA(),t.qZA(),t._UZ(32,"th",14),t._UZ(33,"th"),t._UZ(34,"th"),t._UZ(35,"th"),t._UZ(36,"th"),t._UZ(37,"th"),t.qZA(),t.qZA(),t.TgZ(38,"tbody"),t.YNc(39,Pt,2,1,"ng-container",15),t.qZA(),t.qZA(),t.qZA(),t.qZA()}if(2&a){const e=t.MAs(2),n=t.MAs(4),o=t.oxw();t.xp6(1),t.Q6J("initSort",t.DdM(38,kt))("data",o.rows),t.xp6(2),t.Q6J("nzData",e.tableData)("nzFrontPagination",!1)("nzScroll",t.WLB(39,Jt,e.tableWidth,e.tableHeight))("nzNoResult",t.lcZ(5,22,"NO_IO_MODULES")),t.xp6(5),t.Q6J("nzLeft",e.allowNzLeft)("nzColumnKey","modbus_id")("nzSortFn",!0)("nzSortDirections",t.DdM(42,Ht))("nzSortOrder","ascend"),t.xp6(1),t.Oqu(t.lcZ(10,24,"MODBUS_ID")),t.xp6(2),t.Q6J("nzLeft",e.allowNzLeft),t.xp6(1),t.Oqu(t.lcZ(13,26,"PORT")),t.xp6(3),t.Oqu(t.lcZ(16,28,"PORT_NAME")),t.xp6(3),t.Oqu(t.lcZ(19,30,"DEVICE_TYPE")),t.xp6(3),t.Oqu(t.lcZ(22,32,"ACCESSORY_TYPE")),t.xp6(3),t.Oqu(t.lcZ(25,34,"STATUS")),t.xp6(3),t.Oqu(t.lcZ(28,36,"ACTION")),t.xp6(3),t.Q6J("nzLeft",e.allowNzLeft),t.xp6(2),t.Q6J("nzLeft",e.allowNzLeft),t.xp6(7),t.Q6J("ngForOf",n.data)}}let Qt=(()=>{class a{constructor(e,n,o,i,l,u){this.translate=e,this.toastr=n,this.modalService=o,this.ioModulesService=i,this.webSocketService=l,this.sharedService=u,this.id="load_management_control_io_modules",this.loadingData=!0}ngOnInit(){this.getData()}getData(){this.loadingData=!0,this.subscriptionConfiguration=this.ioModulesService.getIoModulesConfiguration().subscribe(e=>{this.rows=e.ioModules.filter(n=>0!==n.type_id).map(n=>(2===n.type_id&&(n.ports=n.ports.filter(o=>o.port<=2)),n)),this.deviceTypes=e.deviceTypes,this.accessoryTypes=e.accessoryTypes,this.loadingData=!1,this.initLiveSamples()},()=>{})}ngOnDestroy(){this.subscriptionSocket&&(this.webSocketService.setCollectData(),this.subscriptionSocket.unsubscribe()),this.subscriptionConfiguration&&this.subscriptionConfiguration.unsubscribe()}initLiveSamples(){this.webSocketService.setCollectData({object_ids:this.rows.filter(e=>e.modbus_id).map(e=>e.object_id)}),this.subscriptionSocket=this.webSocketService.socket$Observable.subscribe(e=>{e.object_id&&(this.updateTableData(e),this.lastTimestamp=e.timestamp)})}changeStatus(e,n){this.modalService.showConfirm(this.translate.instant(n.status?"IO_MODULES_OPEN_CONFIRM":"IO_MODULES_CLOSE_CONFIRM",{name:"<strong>"+n.name+"</strong>"}),()=>{this.modalService.setLoading(!0),this.ioModulesService.changeStatus({modbus_id:e.modbus_id||0,port:n.port,status:Number(!n.status)}).subscribe(()=>{this.toastr.success(this.translate.instant(n.status?"IO_MODULES_OPEN_CONFIRM_SUCCESS":"IO_MODULES_CLOSE_CONFIRM_SUCCESS",{name:"<strong>"+n.name+"</strong>"})),n.status=Number(!n.status),n.lastManualChangeTimestamp=this.lastTimestamp+1,this.modalService.hide()},()=>{this.toastr.error(this.translate.instant("REQUEST_ERROR")),this.modalService.hide()})})}updateTableData(e){const n=this.rows.find(o=>o.object_id===e.object_id);n&&n.ports.forEach(o=>{(!o.lastManualChangeTimestamp||e.timestamp>o.lastManualChangeTimestamp)&&(o.status=e.data["port"+o.port+"State"])})}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(d.sK),t.Y36(m._),t.Y36(c.Z),t.Y36(Nt.W),t.Y36(P.l),t.Y36(k.F))},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-load-management-control-io-modules"]],hostVars:1,hostBindings:function(e,n){2&e&&t.uIk("id",n.id)},decls:2,vars:2,consts:[[4,"ngIf"],["class","section-content","style","height: calc(100%)",4,"ngIf"],[1,"section-content",2,"height","calc(100%)"],[3,"initSort","data"],["table",""],[3,"nzData","nzFrontPagination","nzScroll","nzNoResult"],["nzTable",""],[3,"nzSortOrderChange"],["nzWidth","120px",3,"nzLeft","nzColumnKey","nzSortFn","nzSortDirections","nzSortOrder"],["nzWidth","100px",3,"nzLeft"],["nzWidth","80px"],[1,"filters"],[1,"input",3,"nzLeft"],["type","text",3,"input"],[3,"nzLeft"],[4,"ngFor","ngForOf"],[3,"id","name","nzControl","ngModel","ngModelChange","click",4,"ngIf"],[3,"id","name","nzControl","ngModel","ngModelChange","click"]],template:function(e,n){1&e&&(t.YNc(0,It,1,0,"app-loader",0),t.YNc(1,Ft,40,43,"div",1)),2&e&&(t.Q6J("ngIf",n.loadingData),t.xp6(1),t.Q6J("ngIf",!n.loadingData))},directives:[M.O5,y.R,z.a,_.N8,_.Om,_.$Z,_.Uo,_._C,_.qn,_.qD,_.p0,M.sg,q.i,T.JJ,T.On],pipes:[d.X$,R.h],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;height:100%}.section-content[_ngcontent-%COMP%]{padding-bottom:0;overflow:hidden}"]}),a})();var Vt=r(8410);const Bt=["table"];function Yt(a,s){1&a&&t._UZ(0,"app-loader")}function jt(a,s){1&a&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&a&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"OPEN")))}function Wt(a,s){1&a&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&a&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"CLOSE")))}function Gt(a,s){1&a&&(t.TgZ(0,"span"),t._uU(1,"-"),t.qZA())}function $t(a,s){if(1&a){const e=t.EpF();t.TgZ(0,"nz-switch",17),t.NdJ("ngModelChange",function(o){return t.CHM(e),t.oxw().$implicit.circuitBreakerState=o})("click",function(){t.CHM(e);const o=t.oxw().$implicit;return t.oxw(2).changeStatus(o)}),t.qZA()}if(2&a){const e=t.oxw(),n=e.index,o=e.$implicit;t.MGl("id","change_circuit_breaker_state_",n,""),t.MGl("name","changeCircuitBreakerState_",n,""),t.Q6J("nzDisabled",!o.enableCommunicationCommands)("nzControl",!0)("ngModel",o.circuitBreakerState)}}function Kt(a,s){1&a&&(t.TgZ(0,"span"),t._uU(1,"-"),t.qZA())}function Xt(a,s){if(1&a&&(t.TgZ(0,"tr"),t.TgZ(1,"td",15),t._uU(2),t.qZA(),t.TgZ(3,"td"),t.TgZ(4,"div"),t._uU(5),t.qZA(),t.qZA(),t.TgZ(6,"td"),t.TgZ(7,"div"),t._uU(8),t.qZA(),t.qZA(),t.TgZ(9,"td"),t.YNc(10,jt,3,3,"span",0),t.YNc(11,Wt,3,3,"span",0),t.YNc(12,Gt,2,0,"span",0),t.qZA(),t.TgZ(13,"td"),t.YNc(14,$t,1,5,"nz-switch",16),t.YNc(15,Kt,2,0,"span",0),t.qZA(),t.qZA()),2&a){const e=s.$implicit;t.oxw();const n=t.MAs(2);t.xp6(1),t.Q6J("nzLeft",n.allowNzLeft),t.xp6(1),t.Oqu(e.modbus_id||"-"),t.xp6(3),t.Oqu(e.name),t.xp6(3),t.Oqu(e.device_type),t.xp6(2),t.Q6J("ngIf",0===e.circuitBreakerState&&e.modbus_id),t.xp6(1),t.Q6J("ngIf",1===e.circuitBreakerState&&e.modbus_id),t.xp6(1),t.Q6J("ngIf",!e.modbus_id),t.xp6(2),t.Q6J("ngIf",e.modbus_id),t.xp6(1),t.Q6J("ngIf",!e.modbus_id)}}const te=function(){return{key:"modbus_id",value:"ascend"}},ee=function(a,s){return{x:a,y:s}},N=function(){return["ascend","descend"]};function ne(a,s){if(1&a){const e=t.EpF();t.TgZ(0,"div",2),t.TgZ(1,"app-table",3,4),t.TgZ(3,"nz-table",5,6),t.ALo(5,"translate"),t.TgZ(6,"thead",7),t.NdJ("nzSortOrderChange",function(o){return t.CHM(e),t.MAs(2).sort(o)}),t.TgZ(7,"tr"),t.TgZ(8,"th",8),t._uU(9),t.ALo(10,"translate"),t.qZA(),t.TgZ(11,"th",9),t._uU(12),t.ALo(13,"translate"),t.qZA(),t.TgZ(14,"th",9),t._uU(15),t.ALo(16,"translate"),t.qZA(),t.TgZ(17,"th",9),t._uU(18),t.ALo(19,"translate"),t.qZA(),t.TgZ(20,"th",10),t._uU(21),t.ALo(22,"translate"),t.qZA(),t.qZA(),t.TgZ(23,"tr",11),t.TgZ(24,"th",12),t.TgZ(25,"input",13),t.NdJ("input",function(o){return t.CHM(e),t.MAs(2).filter(o,"modbus_id","contains")}),t.qZA(),t.qZA(),t._UZ(26,"th"),t._UZ(27,"th"),t._UZ(28,"th"),t._UZ(29,"th"),t.qZA(),t.qZA(),t.TgZ(30,"tbody"),t.YNc(31,Xt,16,9,"tr",14),t.qZA(),t.qZA(),t.qZA(),t.qZA()}if(2&a){const e=t.MAs(2),n=t.MAs(4),o=t.oxw();t.xp6(1),t.Q6J("initSort",t.DdM(40,te))("data",o.rows),t.xp6(2),t.Q6J("nzData",e.tableData)("nzFrontPagination",!1)("nzScroll",t.WLB(41,ee,e.tableWidth,e.tableHeight))("nzNoResult",t.lcZ(5,28,"NO_MOD")),t.xp6(5),t.Q6J("nzLeft",e.allowNzLeft)("nzColumnKey","modbus_id")("nzSortFn",!0)("nzSortDirections",t.DdM(44,N))("nzSortOrder","ascend"),t.xp6(1),t.Oqu(t.lcZ(10,30,"MODBUS_ID")),t.xp6(2),t.Q6J("nzColumnKey","name")("nzSortFn",!0)("nzSortDirections",t.DdM(45,N)),t.xp6(1),t.Oqu(t.lcZ(13,32,"NAME")),t.xp6(2),t.Q6J("nzColumnKey","device_type")("nzSortFn",!0)("nzSortDirections",t.DdM(46,N)),t.xp6(1),t.Oqu(t.lcZ(16,34,"DEVICE_TYPE")),t.xp6(2),t.Q6J("nzColumnKey","circuitBreakerState")("nzSortFn",!0)("nzSortDirections",t.DdM(47,N)),t.xp6(1),t.Oqu(t.lcZ(19,36,"STATE")),t.xp6(2),t.Q6J("nzSortFn",!1),t.xp6(1),t.Oqu(t.lcZ(22,38,"ACTION")),t.xp6(3),t.Q6J("nzLeft",e.allowNzLeft),t.xp6(7),t.Q6J("ngForOf",n.data)}}const ae=[{path:"",redirectTo:"control"},{path:"control",redirectTo:"control/io-modules"},{path:"control",component:Ot,canActivate:[S.a],data:{activeMenu:"LOAD_MANAGEMENT",activeSubMenu:"CONTROL",icon:"icon_abb_24 icon-abb_bar-chart_24",activeTab:"MOD"},children:[{path:"io-modules",component:Qt,canActivate:[S.a],data:{activeMenu:"LOAD_MANAGEMENT",activeSubMenu:"CONTROL",icon:"icon_abb_24 icon-abb_bar-chart_24",activeTab:"IO_MODULES"}},{path:"mod",component:(()=>{class a{constructor(e,n,o,i,l,u){this.translate=e,this.toastr=n,this.modalService=o,this.webSocketService=i,this.sharedService=l,this.modService=u,this.id="load_management_control_mod",this.loadingData=!0}ngOnInit(){this.getData()}getData(){this.loadingData=!0,this.modService.getDevices().subscribe(e=>{this.devices=e.devices.map(n=>({object_id:n.object_id,modbus_id:n.modbus_id,device_type:n.device_type,name:n.name||"",status:n.status,internalCommunicationFailure:65280===n.internalCommunicationFailure?1:0,circuitBreakerState:65280===n.circuitBreakerState?1:0,enableRemoteInputCommands:n.enableRemoteInputCommands,enableCommunicationCommands:n.enableCommunicationCommands,delayBetweenReclosing:n.delayBetweenReclosing,neutralizationTime:n.neutralizationTime})),this.rows=this.devices.filter(n=>"ModAriArh"===n.device_type),this.loadingData=!1,this.initLiveSamples()},()=>{this.toastr.error(this.translate.instant("REQUEST_ERROR"))})}ngOnDestroy(){this.subscriptionSocket&&(this.webSocketService.setCollectData(),this.subscriptionSocket.unsubscribe())}initLiveSamples(){this.webSocketService.setCollectData({object_ids:this.rows.filter(e=>e.modbus_id).map(e=>e.object_id)}),this.subscriptionSocket=this.webSocketService.socket$Observable.subscribe(e=>{e.object_id&&(this.updateTableData(e),this.lastTimestamp=e.timestamp)})}changeStatus(e){e.enableCommunicationCommands&&(1!==e.internalCommunicationFailure?this.modalService.showConfirm(this.translate.instant(e.circuitBreakerState?"MOD_OPEN_CONFIRM":"MOD_CLOSE_CONFIRM",{name:"<strong>"+e.name+"</strong>"}),()=>{this.modalService.setLoading(!0),this.modService.changeStatus({modbus_id:e.modbus_id,address:32769,status:1===e.circuitBreakerState?0:65280}).subscribe(()=>{this.toastr.success(this.translate.instant(e.circuitBreakerState?"MOD_OPEN_CONFIRM_SUCCESS":"MOD_CLOSE_CONFIRM_SUCCESS",{name:"<strong>"+e.name+"</strong>"})),e.status=Number(!e.status),e.lastManualChangeTimestamp=this.lastTimestamp+1,this.modalService.hide(),e.circuitBreakerState=1===e.circuitBreakerState?0:1},()=>{this.toastr.error(this.translate.instant("REQUEST_ERROR")),this.modalService.hide()})}):this.toastr.error(this.translate.instant("MOD_INTERNALCONNECTION_ERROR")))}updateTableData(e){if(1===e.resolution){const n=this.table._data.find(o=>o.object_id===e.object_id);n&&(!n.lastManualChangeTimestamp||e.timestamp>n.lastManualChangeTimestamp)&&(n.circuitBreakerState=65280===e.data.circuitBreakerState?1:0)}}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(d.sK),t.Y36(m._),t.Y36(c.Z),t.Y36(P.l),t.Y36(k.F),t.Y36(Vt.A))},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-load-management-control-mod"]],viewQuery:function(e,n){if(1&e&&t.Gf(Bt,5),2&e){let o;t.iGM(o=t.CRH())&&(n.table=o.first)}},hostVars:1,hostBindings:function(e,n){2&e&&t.uIk("id",n.id)},decls:2,vars:2,consts:[[4,"ngIf"],["class","section-content",4,"ngIf"],[1,"section-content"],[3,"initSort","data"],["table",""],["nzTableLayout","fixed",1,"table-show-changes",3,"nzData","nzFrontPagination","nzScroll","nzNoResult"],["nzTable",""],[3,"nzSortOrderChange"],["nzWidth","120px",3,"nzLeft","nzColumnKey","nzSortFn","nzSortDirections","nzSortOrder"],[3,"nzColumnKey","nzSortFn","nzSortDirections"],["nzWidth","80px",3,"nzSortFn"],[1,"filters"],[1,"input",3,"nzLeft"],["type","text",3,"input"],[4,"ngFor","ngForOf"],[3,"nzLeft"],[3,"id","name","nzDisabled","nzControl","ngModel","ngModelChange","click",4,"ngIf"],[3,"id","name","nzDisabled","nzControl","ngModel","ngModelChange","click"]],template:function(e,n){1&e&&(t.YNc(0,Yt,1,0,"app-loader",0),t.YNc(1,ne,32,48,"div",1)),2&e&&(t.Q6J("ngIf",n.loadingData),t.xp6(1),t.Q6J("ngIf",!n.loadingData))},directives:[M.O5,y.R,z.a,_.N8,_.Om,_.$Z,_.Uo,_._C,_.qn,_.qD,_.p0,M.sg,q.i,T.JJ,T.On],pipes:[d.X$],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;height:100%}.section-content[_ngcontent-%COMP%]{padding-bottom:0;overflow:hidden}"]}),a})(),canActivate:[S.a],data:{activeMenu:"LOAD_MANAGEMENT",activeSubMenu:"CONTROL",icon:"icon_abb_24 icon-abb_bar-chart_24",activeTab:"MOD"}}]},{path:"automations",component:Et,canActivate:[S.a],data:{activeMenu:"LOAD_MANAGEMENT",activeSubMenu:"AUTOMATIONS",icon:"icon_abb_24 icon-abb_bar-chart_24"}},{path:"",redirectTo:"control"}];let ie=(()=>{class a{}return a.\u0275fac=function(e){return new(e||a)},a.\u0275mod=t.oAB({type:a}),a.\u0275inj=t.cJS({providers:[S.a],imports:[[p.Bz.forChild(ae)],p.Bz]}),a})();var se=r(5084);let re=(()=>{class a{}return a.\u0275fac=function(e){return new(e||a)},a.\u0275mod=t.oAB({type:a}),a.\u0275inj=t.cJS({imports:[[se.m,ie]]}),a})()},442:(b,A,r)=>{r.d(A,{h:()=>t});var p=r(5e3),C=r(1062);let t=(()=>{class d{constructor(c){this.translate=c}transform(c,h,v="name"){if(null==c||!h)return"-";const x=h.find(E=>E.id===c);return x?this.translate.instant(x[v]):c}}return d.\u0275fac=function(c){return new(c||d)(p.Y36(C.sK,16))},d.\u0275pipe=p.Yjl({name:"valueFromId",type:d,pure:!0}),d})()},6625:(b,A,r)=>{r.d(A,{W:()=>t});var p=r(5e3),C=r(520);let t=(()=>{class d{constructor(c){this.http=c}getIoModulesConfiguration(){return this.http.get("api/io-modules/configuration")}getIoModules(){return this.http.get("api/io-modules")}setIoModules(c){return this.http.put("api/io-modules",c,{responseType:"text"})}addUnassignedIoModule(c,h,v,x){return this.http.post("api/io-modules/unassigned",{noOfIoModules:c,unassignedIoModuleType:h,ioModuleWord:v,portWord:x},{responseType:"text"})}getHistoricalValues(c){return this.http.post("api/io-modules/history",c)}changeStatus(c){return this.http.post("api/io-modules/port-status",c,{responseType:"text"})}}return d.\u0275fac=function(c){return new(c||d)(p.LFG(C.eN))},d.\u0275prov=p.Yz7({token:d,factory:d.\u0275fac,providedIn:"root"}),d})()},8410:(b,A,r)=>{r.d(A,{A:()=>t});var p=r(5e3),C=r(520);let t=(()=>{class d{constructor(c){this.http=c}getDevices(){return this.http.get("api/mod")}setMod(c){return this.http.put("api/mod",c,{responseType:"text"})}addUnassignedMod(c,h){return this.http.post("api/mod/unassigned",{noOfMods:c,modWord:h},{responseType:"text"})}changeStatus(c){return this.http.post("api/mod/port-status",c,{responseType:"text"})}}return d.\u0275fac=function(c){return new(c||d)(p.LFG(C.eN))},d.\u0275prov=p.Yz7({token:d,factory:d.\u0275fac,providedIn:"root"}),d})()},7618:(b,A,r)=>{r.d(A,{a:()=>d});var p=r(5e3),C=r(4521),t=r(9777);let d=(()=>{class m{constructor(h,v){this.router=h,this.appLoadService=v}canActivate(h,v){return!!this.appLoadService.user.logged||(this.router.navigate(["/login"],{queryParams:{returnUrl:v.url}}),!1)}}return m.\u0275fac=function(h){return new(h||m)(p.LFG(C.F0),p.LFG(t.V))},m.\u0275prov=p.Yz7({token:m,factory:m.\u0275fac}),m})()},5724:(b,A,r)=>{r.d(A,{vK:()=>p,dQ:()=>C,DJ:()=>t,tc:()=>d,wk:()=>m,Sw:()=>c,KS:()=>h,Dl:()=>v,ij:()=>x,Vs:()=>E,OC:()=>I,uS:()=>D,_5:()=>M,tW:()=>y});const p=["#0C74DA","#007A33","#A65033","#7A641B","#4B656A","#28B1B5","#973E82","#8664BF","#0aa","#48c","#944","#2bd","#fa4","#1a4","#323","#31c","#d97","#f5f","#922","#e3d","#137","#9dc","#767","#93c","#1de","#96a","#32c","#74f","#75f","#9ab","#73c","#a53","#4d3","#ba0","#985","#83c","#a14","#f99","#71b","#d8a","#592","#6a7","#0c6","#621","#771","#349","#4f4","#6a1","#e92","#7c5","#7c7","#802","#158","#c8d","#4ec","#b3a","#140","#32a","#041","#f65","#b03","#9f8","#683","#da7","#d2f","#90c","#5c7","#b90","#390","#fa6","#bc4","#420","#c14","#c73","#1ab","#8c1","#793","#d2c","#4a8","#e17","#3ab","#c51","#8d5","#fc2","#30a","#815","#b85","#124","#8a4","#796","#398","#29a","#c22","#8b2","#07f","#b4b"],C={"Energy Values":[{key:"ACTIVE_IMPORT",chart:!0,l1:"activeEnergyImportL1",l2:"activeEnergyImportL2",l3:"activeEnergyImportL3",total:"activeEnergyImportTotal"},{key:"ACTIVE_EXPORT",chart:!0,l1:"activeEnergyExportL1",l2:"activeEnergyExportL2",l3:"activeEnergyExportL3",total:"activeEnergyExportTotal"},{key:"ACTIVE_NET",chart:!0,l1:"activeEnergyNetL1",l2:"activeEnergyNetL2",l3:"activeEnergyNetL3",total:"activeEnergyNetTotal"},{key:"REACTIVE_IMPORT",chart:!0,l1:"reactiveEnergyImportL1",l2:"reactiveEnergyImportL2",l3:"reactiveEnergyImportL3",total:"reactiveEnergyImportTotal"},{key:"REACTIVE_EXPORT",chart:!0,l1:"reactiveEnergyExportL1",l2:"reactiveEnergyExportL2",l3:"reactiveEnergyExportL3",total:"reactiveEnergyExportTotal"},{key:"REACTIVE_NET",chart:!0,l1:"reactiveEnergyNetL1",l2:"reactiveEnergyNetL2",l3:"reactiveEnergyNetL3",total:"reactiveEnergyNetTotal"},{key:"APPARENT_IMPORT",chart:!0,l1:"apparentEnergyImportL1",l2:"apparentEnergyImportL2",l3:"apparentEnergyImportL3",total:"apparentEnergyImportTotal"},{key:"APPARENT_EXPORT",chart:!0,l1:"apparentEnergyExportL1",l2:"apparentEnergyExportL2",l3:"apparentEnergyExportL3",total:"apparentEnergyExportTotal"},{key:"APPARENT_NET",chart:!0,l1:"apparentEnergyNetL1",l2:"apparentEnergyNetL2",l3:"apparentEnergyNetL3",total:"apparentEnergyNetTotal"},{key:"activeImportTotal",chart:!1,total:"activeImportTotal"},{key:"activeExportTotal",chart:!1,total:"activeExportTotal"},{key:"reactiveImportTotal",chart:!1,total:"reactiveImportTotal"},{key:"reactiveExportTotal",chart:!1,total:"reactiveExportTotal"}],"Instantaneous Values":[{key:"ACTIVE_POWER",chart:!0,l1:"activePowerL1",l2:"activePowerL2",l3:"activePowerL3",total:"activePowerTotal"},{key:"threePhaseSysActivePower15AVER",chart:!0,total:"threePhaseSysActivePower15AVER"},{key:"REACTIVE_POWER",chart:!0,l1:"reactivePowerL1",l2:"reactivePowerL2",l3:"reactivePowerL3",total:"reactivePowerTotal"},{key:"APPARENT_POWER",chart:!0,l1:"apparentPowerL1",l2:"apparentPowerL2",l3:"apparentPowerL3",total:"apparentPowerTotal"},{key:"threePhaseSysApparentPower15AVER",chart:!0,total:"threePhaseSysApparentPower15AVER"},{key:"CURRENT",chart:!0,l1:"currentL1",l2:"currentL2",l3:"currentL3",n:"currentN"},{key:"VOLTAGE",chart:!0,l1:"voltageL1",l2:"voltageL2",l3:"voltageL3"},{key:"CURRENT_QUADRANT",chart:!0,l1:"currentQuadrantL1",l2:"currentQuadrantL2",l3:"currentQuadrantL3",total:"currentQuadrantTotal"},{key:"frequency",chart:!0,total:"frequency"},{key:"threePhaseSystemVoltage",chart:!0,total:"threePhaseSystemVoltage"},{key:"threePhaseSystemCurrent",chart:!0,total:"threePhaseSystemCurrent"},{key:"cosPhi3Phase",chart:!0,total:"cosPhi3Phase"},{key:"voltageL1L2",chart:!0,total:"voltageL1L2"},{key:"voltageL3L2",chart:!0,total:"voltageL3L2"},{key:"voltageL1L3",chart:!0,total:"voltageL1L3"}],"Power Quality Values":[{key:"THD_I",chart:!0,l1:"currentHarmonicsTHDL1",l2:"currentHarmonicsTHDL2",l3:"currentHarmonicsTHDL3",n:"currentHarmonicsTHDN"},{key:"THD_U",chart:!0,l1:"voltageHarmonicsTHDL1N",l2:"voltageHarmonicsTHDL2N",l3:"voltageHarmonicsTHDL3N"},{key:"POWER_FACTOR",chart:!0,l1:"powerFactorL1",l2:"powerFactorL2",l3:"powerFactorL3",total:"powerFactorTotal"},{key:"PHASE_ANGLE_POWER",chart:!0,l1:"phaseAnglePowerL1",l2:"phaseAnglePowerL2",l3:"phaseAnglePowerL3",total:"phaseAnglePowerTotal"},{key:"PHASE_ANGLE_VOLTAGE",chart:!0,l1:"phaseAngleVoltageL1",l2:"phaseAngleVoltageL2",l3:"phaseAngleVoltageL3"},{key:"PHASE_ANGLE_CURRENT",chart:!0,l1:"phaseAngleCurrentL1",l2:"phaseAngleCurrentL2",l3:"phaseAngleCurrentL3"},{key:"COS_PHI",chart:!0,l1:"cosPhiL1",l2:"cosPhiL2",l3:"cosPhiL3"},{key:"phaseAngleVoltageL1L2",chart:!0,total:"phaseAngleVoltageL1L2"},{key:"phaseAngleVoltageL3L2",chart:!0,total:"phaseAngleVoltageL3L2"},{key:"phaseAngleVoltageL1L3",chart:!0,total:"phaseAngleVoltageL1L3"}],"Maximum Values":[{key:"MAX_LINE_CURRENT",chart:!1,l1:"maxLineCurrentL1",l2:"maxLineCurrentL2",l3:"maxLineCurrentL3"},{key:"max3PhaseSysActivePower",chart:!1,total:"max3PhaseSysActivePower"},{key:"max3PhaseSysApparentPower",chart:!1,total:"max3PhaseSysApparentPower"},{key:"max3PhaseSysActivePower15Aver",chart:!1,total:"max3PhaseSysActivePower15Aver"},{key:"MAX_ACTIVE_POWER_AVG_15",chart:!1,l1:"maxActivePower15AverL1",l2:"maxActivePower15AverL2",l3:"maxActivePower15AverL3"},{key:"max3PhaseSysApparentPower15Aver",chart:!1,total:"max3PhaseSysApparentPower15Aver"},{key:"MAX_APPARENT_POWER_AVG_15",chart:!1,l1:"maxApparentPower15AverL1",l2:"maxApparentPower15AverL2",l3:"maxApparentPower15AverL3"}],Unbalances:[{key:"UNBALANCES",chart:!0,l1:"unbalancesPhaseVoltage",l2:"unbalancesLineVoltage",l3:"unbalancesCurrent"}]},t=[{id:"integer",text:"INTEGER"},{id:"float",text:"FLOAT"},{id:"string",text:"STRING"},{id:"boolean",text:"BOOLEAN"}],d=[{id:"ABCD",text:"BIG_ENDIAN"},{id:"DCBA",text:"LITTLE_ENDIAN"},{id:"BADC",text:"BIG_ENDIAN_BYTE_SWAP"},{id:"CDAB",text:"LITTLE_ENDIAN_BYTE_SWAP"}],m=[{id:1,text:"READ_COIL_STATUS"},{id:2,text:"READ_INPUT_STATUS"},{id:3,text:"READ_HOLDING_REGISTER"},{id:4,text:"READ_INPUT_REGISTER"}],c=[{id:"C",text:"C"},{id:"T",text:"T"}],h=[{id:0,text:"INTERNAL"},{id:1,text:"EXTERNAL"}],v=[{id:"%",name:"%"},{id:"-",name:"-"},{id:"A",name:"A"},{id:"CO2",name:"CO2"},{id:"Currency",name:"Currency"},{id:"Hz",name:"Hz"},{id:"N/A",name:"N/A"},{id:"V",name:"V"},{id:"VA",name:"VA"},{id:"W",name:"W"},{id:"deg",name:"deg"},{id:"kVAh",name:"kVAh"},{id:"kWh",name:"kWh"},{id:"kvarh",name:"kvarh"},{id:"mA",name:"mA"},{id:"text",name:"text"},{id:"var",name:"var"}],x=[{id:0,name:"NO"},{id:1,name:"YES"}],E=[{id:!1,name:"NO"},{id:!0,name:"YES"}],I=[{group:"VOLTAGE",phase:"L1",variable:"voltageL1"},{group:"VOLTAGE",phase:"L2",variable:"voltageL2"},{group:"VOLTAGE",phase:"L3",variable:"voltageL3"},{group:"CURRENT",phase:"L1",variable:"currentL1"},{group:"CURRENT",phase:"L2",variable:"currentL2"},{group:"CURRENT",phase:"L3",variable:"currentL3"},{group:"ACTIVE_POWER",phase:"L1",variable:"activePowerL1"},{group:"ACTIVE_POWER",phase:"L2",variable:"activePowerL2"},{group:"ACTIVE_POWER",phase:"L3",variable:"activePowerL3"},{group:"VOLTAGE_HARMONICS_THD_L_L",phase:"L1L2",variable:"voltageHarmonicsTHDL1L2"},{group:"VOLTAGE_HARMONICS_THD_L_L",phase:"L3L2",variable:"voltageHarmonicsTHDL3L2"},{group:"VOLTAGE_HARMONICS_THD_L_L",phase:"L1L3",variable:"voltageHarmonicsTHDL1L3"},{group:"CURRENT_HARMONICS_THD",phase:"L1",variable:"currentHarmonicsTHDL1"},{group:"CURRENT_HARMONICS_THD",phase:"L2",variable:"currentHarmonicsTHDL2"},{group:"CURRENT_HARMONICS_THD",phase:"L3",variable:"currentHarmonicsTHDL3"},{group:"CURRENT_HARMONICS_THD",phase:"N",variable:"currentHarmonicsTHDN"},{group:"VOLTAGES_L_L",phase:"L1L2",variable:"voltageL1L2"},{group:"VOLTAGES_L_L",phase:"L3L2",variable:"voltageL3L2"},{group:"VOLTAGES_L_L",phase:"L1L3",variable:"voltageL1L3"},{group:"CURRENT",phase:"N",variable:"currentN"},{group:"REACTIVE_POWER",phase:"L1",variable:"reactivePowerL1"},{group:"REACTIVE_POWER",phase:"L2",variable:"reactivePowerL2"},{group:"REACTIVE_POWER",phase:"L3",variable:"reactivePowerL3"},{group:"POWER_FACTOR",phase:"L1",variable:"powerFactorL1"},{group:"POWER_FACTOR",phase:"L2",variable:"powerFactorL2"},{group:"POWER_FACTOR",phase:"L3",variable:"powerFactorL3"},{group:"VOLTAGE_HARMONICS_THD_L_N",phase:"L1N",variable:"voltageHarmonicsTHDL1N"},{group:"VOLTAGE_HARMONICS_THD_L_N",phase:"L2N",variable:"voltageHarmonicsTHDL2N"},{group:"VOLTAGE_HARMONICS_THD_L_N",phase:"L3N",variable:"voltageHarmonicsTHDL3N"},{group:"COS_PHI",phase:"L1",variable:"cosPhiL1"},{group:"COS_PHI",phase:"L2",variable:"cosPhiL2"},{group:"COS_PHI",phase:"L3",variable:"cosPhiL3"}],D=[{id:0,text:"SYSTEM_EVENT"},{id:1,text:"TYPE_CROSSUP"},{id:2,text:"TYPE_CROSSDOWN"},{id:3,text:"TYPE_STATUS_CHANGE"},{id:4,text:"TYPE_COMMUNICATION_FAILURE"},{id:5,text:"TYPE_COMMUNICATION_RESTORE"},{id:6,text:"TYPE_STATUS_CHANGE_TO_CLOSE"},{id:7,text:"TYPE_STATUS_CHANGE_TO_OPEN"},{id:8,text:"TYPE_AUTOMATION_SUCCESS"},{id:9,text:"TYPE_AUTOMATION_FAILURE"}],M=[{id:"30s",text:"RESOLUTION_30SECONDS",range:3e7},{id:"15min",text:"RESOLUTION_QUARTER",range:9e8},{id:"1h",text:"RESOLUTION_HOUR",range:36e8},{id:"1d",text:"RESOLUTION_DAY",range:31536e6},{id:"1m",text:"RESOLUTION_MONTHS",range:31536e6}],y={"30s":3e4,"15min":9e5,"1h":36e5,"1d":864e5,"1m":2592e6}}}]);